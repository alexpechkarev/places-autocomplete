(function(r,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(r=typeof globalThis<"u"?globalThis:r||self,l(r.PlacesAutocomplete={}))})(this,function(r){"use strict";var H=Object.defineProperty;var $=r=>{throw TypeError(r)};var V=(r,l,d)=>l in r?H(r,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):r[l]=d;var F=(r,l,d)=>V(r,typeof l!="symbol"?l+"":l,d),B=(r,l,d)=>l.has(r)||$("Cannot "+d);var e=(r,l,d)=>(B(r,l,"read from private field"),d?d.call(r):l.get(r)),p=(r,l,d)=>l.has(r)?$("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(r):l.set(r,d),h=(r,l,d,f)=>(B(r,l,"write to private field"),f?f.call(r,d):l.set(r,d),d);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var d,f,O,j,i,L,o,b,c,E,w,k,_,u,R,y,z,G;class l{constructor(t){p(this,f);p(this,O);p(this,j);p(this,i);p(this,L);p(this,o);p(this,b);p(this,c);p(this,E);p(this,w);p(this,k);p(this,_,[]);p(this,u,-1);p(this,R);p(this,y);p(this,z,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});p(this,G,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});F(this,"_debouncedMakeAcRequest",this._debounce(async()=>{if(!e(this,o)||!e(this,o).value){this._reset(),e(this,o)&&e(this,o).setAttribute("aria-expanded","false");return}e(this,L).input=e(this,o).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,L));t&&t.length>0?(e(this,c).replaceChildren(...this._createSuggestionElements(t)),e(this,c).style.display="block",e(this,o).setAttribute("aria-expanded","true")):(this._reset(),e(this,o).setAttribute("aria-expanded","false"))}catch(t){e(this,y).call(this,t),this._reset(),e(this,o)&&e(this,o).setAttribute("aria-expanded","false")}},((d=e(this,i))==null?void 0:d.debounce)??100));if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(h(this,f,document.getElementById(t.containerId)),!e(this,f))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);h(this,O,t.googleMapsApiKey),h(this,j,t.googleMapsApiVersion||"weekly"),h(this,i,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,...t.options}),t.options&&t.options.classes?e(this,i).classes={...e(this,z),...t.options.classes}:e(this,i).classes=e(this,z),h(this,R,t.onResponse||(n=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(n,null,2))})),h(this,y,t.onError||(n=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",n)})),t.requestParams&&Object.keys(t.requestParams).length>0?h(this,L,{...e(this,G),...t.requestParams}):h(this,L,{...e(this,G)}),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,O),v:e(this,j)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,y).call(this,t)}}_debounce(t,n){let s=null;return function(...m){const v=()=>{s=null,t(...m)};s!==null&&clearTimeout(s),s=setTimeout(v,n??100)}}_formatDistance(t,n){if(typeof t!="number"||!e(this,i).distance)return null;let s,a;return n==="km"?(s=(t/1e3).toFixed(2),a="km"):(s=(t/1609.34).toFixed(2),a="miles"),s=s.replace(/\.00$/,""),`${s} ${a}`}async _loadGoogleMapsApi(t){var n,s,a,m="The Google Maps JavaScript API",v="google",N="importLibrary",S="__ib__",I=document,C=window;C=C[v]||(C[v]={});var A=C.maps||(C.maps={}),T=new Set,q=new URLSearchParams,D=()=>n||(n=new Promise(async(P,g)=>{var M;s=I.createElement("script"),q.set("libraries",[...T].join(","));for(a in t)q.set(a.replace(/[A-Z]/g,x=>"_"+x[0].toLowerCase()),t[a]);q.set("callback",v+".maps."+S),s.src=`https://maps.${v}apis.com/maps/api/js?`+q,A[S]=P,s.onerror=()=>n=g(Error(m+" could not load.")),s.nonce=((M=I.querySelector("script[nonce]"))==null?void 0:M.nonce)||"",I.head.append(s)}));A[N]?console.warn(m+" only loads once. Ignoring:",t):A[N]=(P,...g)=>T.add(P)&&D().then(()=>A[N](P,...g))}_createPACStructure(){const t=document.createElement("section");e(this,i).classes.section.split(" ").forEach(m=>m&&t.classList.add(m)),h(this,b,document.createElement("div")),e(this,b).className=e(this,i).classes.container,e(this,b).setAttribute("id",e(this,f)),t.appendChild(e(this,b));const n=document.createElement("div");n.className=e(this,i).classes.icon_container,e(this,b).appendChild(n);const s=document.createElement("div");if(s.innerHTML=e(this,i).classes.icon,n.appendChild(s.firstElementChild),h(this,o,document.createElement("input")),e(this,o).id="input"+e(this,f),e(this,o).type="text",e(this,o).name="search",e(this,o).placeholder=e(this,i).placeholder,e(this,o).autocomplete=e(this,i).autocomplete,e(this,o).className=e(this,i).classes.input,e(this,o).setAttribute("role","combobox"),e(this,o).setAttribute("aria-autocomplete","list"),e(this,o).setAttribute("aria-expanded","false"),e(this,o).setAttribute("aria-controls","pacSuggestions"),e(this,i).autofocus&&(e(this,o).autofocus=!0),e(this,i).label){const m=document.createElement("label");m.htmlFor="labelInput"+e(this,f),m.textContent=e(this,i).label,e(this,b).appendChild(m)}e(this,b).appendChild(e(this,o));const a=document.createElement("div");a.className=e(this,i).classes.kbd_container,h(this,E,document.createElement("kbd")),e(this,E).className=e(this,i).classes.kbd_escape,e(this,E).textContent="Esc",a.appendChild(e(this,E)),h(this,w,document.createElement("kbd")),e(this,w).className=e(this,i).classes.kbd_up,e(this,w).innerHTML="&#8593;",a.appendChild(e(this,w)),h(this,k,document.createElement("kbd")),e(this,k).className=e(this,i).classes.kbd_down,e(this,k).innerHTML="&#8595;",a.appendChild(e(this,k)),e(this,b).appendChild(a),h(this,c,document.createElement("ul")),e(this,c).id="pacSuggestions",e(this,c).className=e(this,i).classes.ul,e(this,c).style.display="none",e(this,c).setAttribute("role","listbox"),e(this,b).appendChild(e(this,c)),e(this,f).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,o)?(e(this,o).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,o).addEventListener("blur",()=>{setTimeout(()=>{e(this,c)&&!e(this,c).contains(document.activeElement)&&(e(this,c).style.display="none",e(this,o).setAttribute("aria-expanded","false"))},200)}),e(this,o).addEventListener("focus",()=>{e(this,o).value&&e(this,_).length>0&&(e(this,c).style.display="block",e(this,o).setAttribute("aria-expanded","true"))})):e(this,y).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,y).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1){h(this,u,-1),e(this,o)&&(e(this,o).value=""),h(this,_,[]),h(this,u,-1),e(this,c)&&(e(this,c).innerHTML="",e(this,c).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,c)&&Array.from(e(this,c).children).forEach(t=>{e(this,i).classes.li_current.split(" ").forEach(s=>t.classList.remove(s));const n=t.querySelector("a");n&&e(this,i).classes.li_a_current.split(" ").forEach(s=>n.classList.remove(s))})}_onKeyDown(t){if(!(!e(this,_).length||!e(this,c)||e(this,c).style.display==="none"))if(this._resetLiClasses(),t.key==="ArrowDown"){t.preventDefault(),h(this,u,Math.min(e(this,u)+1,e(this,_).length-1)),e(this,u)<0&&h(this,u,0);const n=e(this,c).children.item(e(this,u));if(n){const s=n.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(a=>n.classList.add(a)),s&&e(this,i).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),n.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.remove(s)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),h(this,u,Math.max(e(this,u)-1,0));const n=e(this,c).children.item(e(this,u));if(n){const s=n.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(a=>n.classList.add(a)),s&&e(this,i).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),n.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.remove(s)}),300)}else t.key==="Enter"?(t.preventDefault(),e(this,u)>=0&&e(this,u)<e(this,_).length&&this._onPlaceSelected(e(this,_)[e(this,u)].place)):t.key==="Escape"&&(t.preventDefault(),e(this,i).classes.kbd_active.split(" ").forEach(n=>{var s;return(s=e(this,E))==null?void 0:s.classList.add(n)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(n=>{var s;return(s=e(this,E))==null?void 0:s.classList.remove(n)}),300),this._reset(!0))}_createSuggestionElements(t){return h(this,_,[]),t.map((n,s)=>{e(this,_).push({id:s+1,description:n.placePrediction.toString(),place:n.placePrediction.toPlace()});const a=document.createElement("div");a.className=e(this,i).classes.li_div_container;const m=document.createElement("div");m.className=e(this,i).classes.li_div_one,a.appendChild(m);const v=document.createElement("p");v.className=e(this,i).classes.li_div_one_p;const N=n.placePrediction.text,S=N.text,I=N.matches;let C=0;I.sort((x,K)=>x.startOffset-K.startOffset);const A=document.createElement("span"),T=document.createElement("span");T.classList=e(this,i).classes.highlight??"font-bold";for(const x of I)A.textContent+=S.substring(C,x.startOffset),x.startOffset>0&&S.charAt(x.startOffset-1)==" "&&(T.textContent+=" "),T.textContent+=S.substring(x.startOffset,x.endOffset),C=x.endOffset;const q=document.createTextNode(S.substring(C));A.appendChild(T),A.appendChild(q),v.appendChild(A),m.appendChild(v),a.appendChild(m);const D=document.createElement("div");D.className=e(this,i).classes.li_div_two,a.appendChild(D);const P=document.createElement("p");P.className=e(this,i).classes.li_div_two_p,P.textContent=this._formatDistance(n.placePrediction.distanceMeters,e(this,i).distance_units??"km"),D.appendChild(P);const g=document.createElement("a");g.href="javascript:void(0)",g.tabIndex=s+1,g.className=e(this,i).classes.li_a,g.addEventListener("click",()=>{this._onPlaceSelected(n.placePrediction.toPlace())}),g.appendChild(a),g.appendChild(D);const M=document.createElement("li");return M.id=`option-${s+1}`,M.className=e(this,i).classes.li,M.appendChild(g),M})}async _onPlaceSelected(t){try{await t.fetchFields({fields:["displayName","formattedAddress","addressComponents"]}),e(this,R).call(this,t.toJSON())}catch(n){console.error("Error fetching place details:",n),e(this,y).call(this,n)}finally{this._reset(!0)}}_refreshToken(){try{e(this,L).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,y).call(this,t)}}clear(){this._reset(!0)}destroy(){e(this,o)&&e(this,o).removeEventListener("input",this._debouncedMakeAcRequest),e(this,f)&&e(this,b)&&e(this,f).removeChild(e(this,b).parentElement);for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}f=new WeakMap,O=new WeakMap,j=new WeakMap,i=new WeakMap,L=new WeakMap,o=new WeakMap,b=new WeakMap,c=new WeakMap,E=new WeakMap,w=new WeakMap,k=new WeakMap,_=new WeakMap,u=new WeakMap,R=new WeakMap,y=new WeakMap,z=new WeakMap,G=new WeakMap,r.PlacesAutocomplete=l,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
