(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o.PlacesAutocomplete={}))})(this,function(o){"use strict";var J=Object.defineProperty;var B=o=>{throw TypeError(o)};var U=(o,l,p)=>l in o?J(o,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):o[l]=p;var H=(o,l,p)=>U(o,typeof l!="symbol"?l+"":l,p),V=(o,l,p)=>l.has(o)||B("Cannot "+p);var e=(o,l,p)=>(V(o,l,"read from private field"),p?p.call(o):l.get(o)),d=(o,l,p)=>l.has(o)?B("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(o):l.set(o,p),h=(o,l,p,g)=>(V(o,l,"write to private field"),g?g.call(o,p):l.set(o,p),p);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var p,g,L,F,R,n,S,r,f,c,E,w,k,b,u,z,y,G,K,N;class l{constructor(t){d(this,g);d(this,L);d(this,F);d(this,R);d(this,n);d(this,S);d(this,r);d(this,f);d(this,c);d(this,E);d(this,w);d(this,k);d(this,b,[]);d(this,u,-1);d(this,z);d(this,y);d(this,G,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});d(this,K,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});d(this,N,["formattedAddress","addressComponents"]);H(this,"_debouncedMakeAcRequest",this._debounce(async()=>{if(!e(this,r)||!e(this,r).value){this._reset(),e(this,r)&&e(this,r).setAttribute("aria-expanded","false");return}e(this,S).input=e(this,r).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,S));t&&t.length>0?(e(this,c).replaceChildren(...this._createSuggestionElements(t)),e(this,c).style.display="block",e(this,r).setAttribute("aria-expanded","true")):(this._reset(),e(this,r).setAttribute("aria-expanded","false"))}catch(t){e(this,y).call(this,t),this._reset()}},((p=e(this,n))==null?void 0:p.debounce)??100));if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(h(this,g,t.containerId),h(this,L,document.getElementById(t.containerId)),!e(this,L))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);h(this,F,t.googleMapsApiKey),h(this,R,t.googleMapsApiVersion||"weekly"),h(this,n,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,clear_input:!0,...t.options}),t.options&&t.options.classes?e(this,n).classes={...e(this,G),...t.options.classes}:e(this,n).classes=e(this,G),t.fetchFields&&Array.isArray(t.fetchFields)&&h(this,N,[...new Set([...e(this,N),...t.fetchFields])].filter(i=>i)),h(this,z,t.onResponse||(i=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(i,null,2))})),h(this,y,t.onError||(i=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",i)})),t.requestParams&&Object.keys(t.requestParams).length>0?h(this,S,{...e(this,K),...t.requestParams}):h(this,S,{...e(this,K)}),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,F),v:e(this,R)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,y).call(this,t)}}_debounce(t,i){let s=null;return function(...m){const v=()=>{s=null,t(...m)};s!==null&&clearTimeout(s),s=setTimeout(v,i??100)}}_formatDistance(t,i){if(typeof t!="number"||!e(this,n).distance)return null;let s,a;return i==="km"?(s=(t/1e3).toFixed(2),a="km"):(s=(t/1609.34).toFixed(2),a="miles"),s=s.replace(/\.00$/,""),`${s} ${a}`}async _loadGoogleMapsApi(t){var i,s,a,m="The Google Maps JavaScript API",v="google",q="importLibrary",T="__ib__",O=document,A=window;A=A[v]||(A[v]={});var C=A.maps||(A.maps={}),M=new Set,D=new URLSearchParams,j=()=>i||(i=new Promise(async(P,_)=>{var I;s=O.createElement("script"),D.set("libraries",[...M].join(","));for(a in t)D.set(a.replace(/[A-Z]/g,x=>"_"+x[0].toLowerCase()),t[a]);D.set("callback",v+".maps."+T),s.src=`https://maps.${v}apis.com/maps/api/js?`+D,C[T]=P,s.onerror=()=>i=_(Error(m+" could not load.")),s.nonce=((I=O.querySelector("script[nonce]"))==null?void 0:I.nonce)||"",O.head.append(s)}));C[q]?console.warn(m+" only loads once. Ignoring:",t):C[q]=(P,..._)=>M.add(P)&&j().then(()=>C[q](P,..._))}_createPACStructure(){const t=document.createElement("section");e(this,n).classes.section.split(" ").forEach(m=>m&&t.classList.add(m)),h(this,f,document.createElement("div")),e(this,f).className=e(this,n).classes.container,e(this,f).setAttribute("id",e(this,g)+"-div"),t.appendChild(e(this,f));const i=document.createElement("div");i.className=e(this,n).classes.icon_container,e(this,f).appendChild(i);const s=document.createElement("div");if(s.innerHTML=e(this,n).classes.icon,i.appendChild(s.firstElementChild),h(this,r,document.createElement("input")),e(this,r).id=e(this,g)+"-input",e(this,r).type="text",e(this,r).name="search",e(this,r).placeholder=e(this,n).placeholder,e(this,r).autocomplete=e(this,n).autocomplete,e(this,r).className=e(this,n).classes.input,e(this,r).setAttribute("role","combobox"),e(this,r).setAttribute("aria-autocomplete","list"),e(this,r).setAttribute("aria-expanded","false"),e(this,r).setAttribute("aria-controls","pacSuggestions"),e(this,n).autofocus&&(e(this,r).autofocus=!0),e(this,n).label){const m=document.createElement("label");m.htmlFor=e(this,g)+"-labelInput",m.textContent=e(this,n).label,e(this,f).appendChild(m)}e(this,f).appendChild(e(this,r));const a=document.createElement("div");a.className=e(this,n).classes.kbd_container,h(this,E,document.createElement("kbd")),e(this,E).className=e(this,n).classes.kbd_escape,e(this,E).textContent="Esc",a.appendChild(e(this,E)),h(this,w,document.createElement("kbd")),e(this,w).className=e(this,n).classes.kbd_up,e(this,w).innerHTML="&#8593;",a.appendChild(e(this,w)),h(this,k,document.createElement("kbd")),e(this,k).className=e(this,n).classes.kbd_down,e(this,k).innerHTML="&#8595;",a.appendChild(e(this,k)),e(this,f).appendChild(a),h(this,c,document.createElement("ul")),e(this,c).id="pacSuggestions",e(this,c).className=e(this,n).classes.ul,e(this,c).style.display="none",e(this,c).setAttribute("role","listbox"),e(this,f).appendChild(e(this,c)),e(this,L).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,r)?(e(this,r).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,r).addEventListener("blur",()=>{setTimeout(()=>{e(this,c)&&!e(this,c).contains(document.activeElement)&&(e(this,c).style.display="none",e(this,r).setAttribute("aria-expanded","false"))},200)}),e(this,r).addEventListener("focus",()=>{e(this,r).value&&e(this,b).length>0&&(e(this,c).style.display="block",e(this,r).setAttribute("aria-expanded","true"))})):e(this,y).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,y).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1,i=null){h(this,u,-1),e(this,r)&&e(this,n).clear_input==!1&&i&&i.formattedAddress?e(this,r).value=i.formattedAddress:e(this,r)&&(e(this,r).value=""),e(this,r)&&(e(this,r).setAttribute("aria-expanded","false"),e(this,r).blur()),h(this,b,[]),h(this,u,-1),e(this,c)&&(e(this,c).innerHTML="",e(this,c).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,c)&&Array.from(e(this,c).children).forEach(t=>{e(this,n).classes.li_current.split(" ").forEach(s=>t.classList.remove(s));const i=t.querySelector("a");i&&e(this,n).classes.li_a_current.split(" ").forEach(s=>i.classList.remove(s))})}_onKeyDown(t){if(this._resetLiClasses(),t.key==="Escape"&&(t.preventDefault(),e(this,n).classes.kbd_active.split(" ").forEach(i=>{var s;return(s=e(this,E))==null?void 0:s.classList.add(i)}),setTimeout(()=>e(this,n).classes.kbd_active.split(" ").forEach(i=>{var s;return(s=e(this,E))==null?void 0:s.classList.remove(i)}),300),this._reset(!0)),!(!e(this,b).length||!e(this,c)||e(this,c).style.display==="none"))if(t.key==="ArrowDown"){t.preventDefault(),h(this,u,Math.min(e(this,u)+1,e(this,b).length-1)),e(this,u)<0&&h(this,u,0);const i=e(this,c).children.item(e(this,u));if(i){const s=i.querySelector("a");e(this,n).classes.li_current.split(" ").forEach(a=>i.classList.add(a)),s&&e(this,n).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),i.scrollIntoView({block:"nearest"})}e(this,n).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,n).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.remove(s)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),h(this,u,Math.max(e(this,u)-1,0));const i=e(this,c).children.item(e(this,u));if(i){const s=i.querySelector("a");e(this,n).classes.li_current.split(" ").forEach(a=>i.classList.add(a)),s&&e(this,n).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),i.scrollIntoView({block:"nearest"})}e(this,n).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,n).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.remove(s)}),300)}else t.key==="Enter"&&(t.preventDefault(),e(this,u)>=0&&e(this,u)<e(this,b).length&&this._onPlaceSelected(e(this,b)[e(this,u)].place))}_createSuggestionElements(t){return h(this,b,[]),t.map((i,s)=>{e(this,b).push({id:s+1,description:i.placePrediction.toString(),place:i.placePrediction.toPlace()});const a=document.createElement("div");a.className=e(this,n).classes.li_div_container;const m=document.createElement("div");m.className=e(this,n).classes.li_div_one,a.appendChild(m);const v=document.createElement("p");v.className=e(this,n).classes.li_div_one_p;const q=i.placePrediction.text,T=q.text,O=q.matches;let A=0;O.sort((x,$)=>x.startOffset-$.startOffset);const C=document.createElement("span"),M=document.createElement("span");M.classList=e(this,n).classes.highlight??"font-bold";for(const x of O)C.textContent+=T.substring(A,x.startOffset),x.startOffset>0&&T.charAt(x.startOffset-1)==" "&&(M.textContent+=" "),M.textContent+=T.substring(x.startOffset,x.endOffset),A=x.endOffset;const D=document.createTextNode(T.substring(A));C.appendChild(M),C.appendChild(D),v.appendChild(C),m.appendChild(v),a.appendChild(m);const j=document.createElement("div");j.className=e(this,n).classes.li_div_two,a.appendChild(j);const P=document.createElement("p");P.className=e(this,n).classes.li_div_two_p,P.textContent=this._formatDistance(i.placePrediction.distanceMeters,e(this,n).distance_units??"km"),j.appendChild(P);const _=document.createElement("a");_.href="javascript:void(0)",_.tabIndex=s+1,_.className=e(this,n).classes.li_a,_.addEventListener("click",()=>{this._onPlaceSelected(i.placePrediction.toPlace())}),_.appendChild(a),_.appendChild(j);const I=document.createElement("li");return I.id=`option-${s+1}`,I.className=e(this,n).classes.li,I.appendChild(_),I})}async _onPlaceSelected(t){let i=null;try{await t.fetchFields({fields:e(this,N)}),i=t.toJSON(),e(this,z).call(this,i)}catch(s){console.error("Error fetching place details:",s),e(this,y).call(this,s)}finally{this._reset(!0,i)}}_refreshToken(){try{e(this,S).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,y).call(this,t)}}clear(){this._reset(!0)}destroy(){e(this,r)&&e(this,r).removeEventListener("input",this._debouncedMakeAcRequest),e(this,L)&&e(this,f)&&e(this,L).removeChild(e(this,f).parentElement);for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}g=new WeakMap,L=new WeakMap,F=new WeakMap,R=new WeakMap,n=new WeakMap,S=new WeakMap,r=new WeakMap,f=new WeakMap,c=new WeakMap,E=new WeakMap,w=new WeakMap,k=new WeakMap,b=new WeakMap,u=new WeakMap,z=new WeakMap,y=new WeakMap,G=new WeakMap,K=new WeakMap,N=new WeakMap,o.PlacesAutocomplete=l,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
