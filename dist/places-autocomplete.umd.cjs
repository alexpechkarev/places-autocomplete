(function(r,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(r=typeof globalThis<"u"?globalThis:r||self,l(r.PlacesAutocomplete={}))})(this,function(r){"use strict";var V=Object.defineProperty;var F=r=>{throw TypeError(r)};var J=(r,l,p)=>l in r?V(r,l,{enumerable:!0,configurable:!0,writable:!0,value:p}):r[l]=p;var B=(r,l,p)=>J(r,typeof l!="symbol"?l+"":l,p),H=(r,l,p)=>l.has(r)||F("Cannot "+p);var e=(r,l,p)=>(H(r,l,"read from private field"),p?p.call(r):l.get(r)),d=(r,l,p)=>l.has(r)?F("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(r):l.set(r,p),h=(r,l,p,g)=>(H(r,l,"write to private field"),g?g.call(r,p):l.set(r,p),p);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var p,g,L,j,R,i,P,o,f,c,E,w,k,b,u,z,y,G,K;class l{constructor(t){d(this,g);d(this,L);d(this,j);d(this,R);d(this,i);d(this,P);d(this,o);d(this,f);d(this,c);d(this,E);d(this,w);d(this,k);d(this,b,[]);d(this,u,-1);d(this,z);d(this,y);d(this,G,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});d(this,K,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});B(this,"_debouncedMakeAcRequest",this._debounce(async()=>{if(!e(this,o)||!e(this,o).value){this._reset(),e(this,o)&&e(this,o).setAttribute("aria-expanded","false");return}e(this,P).input=e(this,o).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,P));t&&t.length>0?(e(this,c).replaceChildren(...this._createSuggestionElements(t)),e(this,c).style.display="block",e(this,o).setAttribute("aria-expanded","true")):(this._reset(),e(this,o).setAttribute("aria-expanded","false"))}catch(t){e(this,y).call(this,t),this._reset(),e(this,o)&&e(this,o).setAttribute("aria-expanded","false")}},((p=e(this,i))==null?void 0:p.debounce)??100));if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(h(this,g,t.containerId),h(this,L,document.getElementById(t.containerId)),!e(this,L))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);h(this,j,t.googleMapsApiKey),h(this,R,t.googleMapsApiVersion||"weekly"),h(this,i,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,...t.options}),t.options&&t.options.classes?e(this,i).classes={...e(this,G),...t.options.classes}:e(this,i).classes=e(this,G),h(this,z,t.onResponse||(n=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(n,null,2))})),h(this,y,t.onError||(n=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",n)})),t.requestParams&&Object.keys(t.requestParams).length>0?h(this,P,{...e(this,K),...t.requestParams}):h(this,P,{...e(this,K)}),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,j),v:e(this,R)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,y).call(this,t)}}_debounce(t,n){let s=null;return function(...m){const v=()=>{s=null,t(...m)};s!==null&&clearTimeout(s),s=setTimeout(v,n??100)}}_formatDistance(t,n){if(typeof t!="number"||!e(this,i).distance)return null;let s,a;return n==="km"?(s=(t/1e3).toFixed(2),a="km"):(s=(t/1609.34).toFixed(2),a="miles"),s=s.replace(/\.00$/,""),`${s} ${a}`}async _loadGoogleMapsApi(t){var n,s,a,m="The Google Maps JavaScript API",v="google",I="importLibrary",T="__ib__",q=document,C=window;C=C[v]||(C[v]={});var A=C.maps||(C.maps={}),M=new Set,D=new URLSearchParams,O=()=>n||(n=new Promise(async(S,_)=>{var N;s=q.createElement("script"),D.set("libraries",[...M].join(","));for(a in t)D.set(a.replace(/[A-Z]/g,x=>"_"+x[0].toLowerCase()),t[a]);D.set("callback",v+".maps."+T),s.src=`https://maps.${v}apis.com/maps/api/js?`+D,A[T]=S,s.onerror=()=>n=_(Error(m+" could not load.")),s.nonce=((N=q.querySelector("script[nonce]"))==null?void 0:N.nonce)||"",q.head.append(s)}));A[I]?console.warn(m+" only loads once. Ignoring:",t):A[I]=(S,..._)=>M.add(S)&&O().then(()=>A[I](S,..._))}_createPACStructure(){const t=document.createElement("section");e(this,i).classes.section.split(" ").forEach(m=>m&&t.classList.add(m)),h(this,f,document.createElement("div")),e(this,f).className=e(this,i).classes.container,e(this,f).setAttribute("id",e(this,g)+"-div"),t.appendChild(e(this,f));const n=document.createElement("div");n.className=e(this,i).classes.icon_container,e(this,f).appendChild(n);const s=document.createElement("div");if(s.innerHTML=e(this,i).classes.icon,n.appendChild(s.firstElementChild),h(this,o,document.createElement("input")),e(this,o).id=e(this,g)+"-input",e(this,o).type="text",e(this,o).name="search",e(this,o).placeholder=e(this,i).placeholder,e(this,o).autocomplete=e(this,i).autocomplete,e(this,o).className=e(this,i).classes.input,e(this,o).setAttribute("role","combobox"),e(this,o).setAttribute("aria-autocomplete","list"),e(this,o).setAttribute("aria-expanded","false"),e(this,o).setAttribute("aria-controls","pacSuggestions"),e(this,i).autofocus&&(e(this,o).autofocus=!0),e(this,i).label){const m=document.createElement("label");m.htmlFor=e(this,g)+"-labelInput",m.textContent=e(this,i).label,e(this,f).appendChild(m)}e(this,f).appendChild(e(this,o));const a=document.createElement("div");a.className=e(this,i).classes.kbd_container,h(this,E,document.createElement("kbd")),e(this,E).className=e(this,i).classes.kbd_escape,e(this,E).textContent="Esc",a.appendChild(e(this,E)),h(this,w,document.createElement("kbd")),e(this,w).className=e(this,i).classes.kbd_up,e(this,w).innerHTML="&#8593;",a.appendChild(e(this,w)),h(this,k,document.createElement("kbd")),e(this,k).className=e(this,i).classes.kbd_down,e(this,k).innerHTML="&#8595;",a.appendChild(e(this,k)),e(this,f).appendChild(a),h(this,c,document.createElement("ul")),e(this,c).id="pacSuggestions",e(this,c).className=e(this,i).classes.ul,e(this,c).style.display="none",e(this,c).setAttribute("role","listbox"),e(this,f).appendChild(e(this,c)),e(this,L).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,o)?(e(this,o).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,o).addEventListener("blur",()=>{setTimeout(()=>{e(this,c)&&!e(this,c).contains(document.activeElement)&&(e(this,c).style.display="none",e(this,o).setAttribute("aria-expanded","false"))},200)}),e(this,o).addEventListener("focus",()=>{e(this,o).value&&e(this,b).length>0&&(e(this,c).style.display="block",e(this,o).setAttribute("aria-expanded","true"))})):e(this,y).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,y).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1){h(this,u,-1),e(this,o)&&(e(this,o).value=""),h(this,b,[]),h(this,u,-1),e(this,c)&&(e(this,c).innerHTML="",e(this,c).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,c)&&Array.from(e(this,c).children).forEach(t=>{e(this,i).classes.li_current.split(" ").forEach(s=>t.classList.remove(s));const n=t.querySelector("a");n&&e(this,i).classes.li_a_current.split(" ").forEach(s=>n.classList.remove(s))})}_onKeyDown(t){if(!(!e(this,b).length||!e(this,c)||e(this,c).style.display==="none"))if(this._resetLiClasses(),t.key==="ArrowDown"){t.preventDefault(),h(this,u,Math.min(e(this,u)+1,e(this,b).length-1)),e(this,u)<0&&h(this,u,0);const n=e(this,c).children.item(e(this,u));if(n){const s=n.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(a=>n.classList.add(a)),s&&e(this,i).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),n.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,k))==null?void 0:a.classList.remove(s)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),h(this,u,Math.max(e(this,u)-1,0));const n=e(this,c).children.item(e(this,u));if(n){const s=n.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(a=>n.classList.add(a)),s&&e(this,i).classes.li_a_current.split(" ").forEach(a=>s.classList.add(a)),n.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.add(s)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(s=>{var a;return(a=e(this,w))==null?void 0:a.classList.remove(s)}),300)}else t.key==="Enter"?(t.preventDefault(),e(this,u)>=0&&e(this,u)<e(this,b).length&&this._onPlaceSelected(e(this,b)[e(this,u)].place)):t.key==="Escape"&&(t.preventDefault(),e(this,i).classes.kbd_active.split(" ").forEach(n=>{var s;return(s=e(this,E))==null?void 0:s.classList.add(n)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(n=>{var s;return(s=e(this,E))==null?void 0:s.classList.remove(n)}),300),this._reset(!0))}_createSuggestionElements(t){return h(this,b,[]),t.map((n,s)=>{e(this,b).push({id:s+1,description:n.placePrediction.toString(),place:n.placePrediction.toPlace()});const a=document.createElement("div");a.className=e(this,i).classes.li_div_container;const m=document.createElement("div");m.className=e(this,i).classes.li_div_one,a.appendChild(m);const v=document.createElement("p");v.className=e(this,i).classes.li_div_one_p;const I=n.placePrediction.text,T=I.text,q=I.matches;let C=0;q.sort((x,$)=>x.startOffset-$.startOffset);const A=document.createElement("span"),M=document.createElement("span");M.classList=e(this,i).classes.highlight??"font-bold";for(const x of q)A.textContent+=T.substring(C,x.startOffset),x.startOffset>0&&T.charAt(x.startOffset-1)==" "&&(M.textContent+=" "),M.textContent+=T.substring(x.startOffset,x.endOffset),C=x.endOffset;const D=document.createTextNode(T.substring(C));A.appendChild(M),A.appendChild(D),v.appendChild(A),m.appendChild(v),a.appendChild(m);const O=document.createElement("div");O.className=e(this,i).classes.li_div_two,a.appendChild(O);const S=document.createElement("p");S.className=e(this,i).classes.li_div_two_p,S.textContent=this._formatDistance(n.placePrediction.distanceMeters,e(this,i).distance_units??"km"),O.appendChild(S);const _=document.createElement("a");_.href="javascript:void(0)",_.tabIndex=s+1,_.className=e(this,i).classes.li_a,_.addEventListener("click",()=>{this._onPlaceSelected(n.placePrediction.toPlace())}),_.appendChild(a),_.appendChild(O);const N=document.createElement("li");return N.id=`option-${s+1}`,N.className=e(this,i).classes.li,N.appendChild(_),N})}async _onPlaceSelected(t){try{await t.fetchFields({fields:["displayName","formattedAddress","addressComponents"]}),e(this,z).call(this,t.toJSON())}catch(n){console.error("Error fetching place details:",n),e(this,y).call(this,n)}finally{this._reset(!0)}}_refreshToken(){try{e(this,P).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,y).call(this,t)}}clear(){this._reset(!0)}destroy(){e(this,o)&&e(this,o).removeEventListener("input",this._debouncedMakeAcRequest),e(this,L)&&e(this,f)&&e(this,L).removeChild(e(this,f).parentElement);for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}g=new WeakMap,L=new WeakMap,j=new WeakMap,R=new WeakMap,i=new WeakMap,P=new WeakMap,o=new WeakMap,f=new WeakMap,c=new WeakMap,E=new WeakMap,w=new WeakMap,k=new WeakMap,b=new WeakMap,u=new WeakMap,z=new WeakMap,y=new WeakMap,G=new WeakMap,K=new WeakMap,r.PlacesAutocomplete=l,Object.defineProperty(r,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
