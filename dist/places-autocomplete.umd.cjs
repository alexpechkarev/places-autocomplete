(function(l,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(l=typeof globalThis<"u"?globalThis:l||self,o(l.PlacesAutocomplete={}))})(this,function(l){"use strict";var Z=Object.defineProperty;var V=l=>{throw TypeError(l)};var Q=(l,o,u)=>o in l?Z(l,o,{enumerable:!0,configurable:!0,writable:!0,value:u}):l[o]=u;var J=(l,o,u)=>Q(l,typeof o!="symbol"?o+"":o,u),U=(l,o,u)=>o.has(l)||V("Cannot "+u);var e=(l,o,u)=>(U(l,o,"read from private field"),u?u.call(l):o.get(l)),d=(l,o,u)=>o.has(l)?V("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(l):o.set(l,u),h=(l,o,u,x)=>(U(l,o,"write to private field"),x?x.call(l,u):o.set(l,u),u);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var u,x,E,z,G,s,A,i,p,c,b,_,y,g,m,K,k,$,F,q,I,B;class o{constructor(t){d(this,x);d(this,E);d(this,z);d(this,G);d(this,s);d(this,A);d(this,i);d(this,p);d(this,c);d(this,b);d(this,_);d(this,y);d(this,g,[]);d(this,m,-1);d(this,K);d(this,k);d(this,$,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,clear_input:!0});d(this,F,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});d(this,q,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});d(this,I,["formattedAddress","addressComponents"]);d(this,B,["formattedAddress","addressComponents"]);J(this,"_debouncedMakeAcRequest",this._debounce(async()=>{if(!e(this,i)||!e(this,i).value){this._reset(),e(this,i)&&e(this,i).setAttribute("aria-expanded","false");return}e(this,A).input=e(this,i).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,A));t&&t.length>0?(e(this,c).replaceChildren(...this._createSuggestionElements(t)),e(this,c).style.display="block",e(this,i).setAttribute("aria-expanded","true")):(this._reset(),e(this,i).setAttribute("aria-expanded","false"))}catch(t){e(this,k).call(this,t),this._reset()}},((u=e(this,s))==null?void 0:u.debounce)??100));if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(h(this,x,t.containerId),h(this,E,document.getElementById(t.containerId)),!e(this,E))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);h(this,z,t.googleMapsApiKey),h(this,G,t.googleMapsApiVersion||"weekly"),h(this,s,{...e(this,$),...t.options}),t.options&&t.options.classes?e(this,s).classes={...e(this,F),...t.options.classes}:e(this,s).classes=e(this,F),t.fetchFields&&Array.isArray(t.fetchFields)&&this._setFetchFields(t.fetchFields),h(this,K,t.onResponse||(a=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(a,null,2))})),h(this,k,t.onError||(a=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",a)})),t.requestParams&&Object.keys(t.requestParams).length>0?h(this,A,{...e(this,q),...t.requestParams}):h(this,A,{...e(this,q)}),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,z),v:e(this,G)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,k).call(this,t)}}_setFetchFields(t){Array.isArray(t)&&t.length>0&&h(this,I,[...new Set([...e(this,B),...t])].filter(a=>a))}_debounce(t,a){let n=null;return function(...f){const w=()=>{n=null,t(...f)};n!==null&&clearTimeout(n),n=setTimeout(w,a??100)}}_formatDistance(t,a){if(typeof t!="number"||!e(this,s).distance)return null;let n,r;return a==="km"?(n=(t/1e3).toFixed(2),r="km"):(n=(t/1609.34).toFixed(2),r="miles"),n=n.replace(/\.00$/,""),`${n} ${r}`}async _loadGoogleMapsApi(t){var a,n,r,f="The Google Maps JavaScript API",w="google",O="importLibrary",N="__ib__",j=document,L=window;L=L[w]||(L[w]={});var S=L.maps||(L.maps={}),T=new Set,D=new URLSearchParams,R=()=>a||(a=new Promise(async(P,v)=>{var M;n=j.createElement("script"),D.set("libraries",[...T].join(","));for(r in t)D.set(r.replace(/[A-Z]/g,C=>"_"+C[0].toLowerCase()),t[r]);D.set("callback",w+".maps."+N),n.src=`https://maps.${w}apis.com/maps/api/js?`+D,S[N]=P,n.onerror=()=>a=v(Error(f+" could not load.")),n.nonce=((M=j.querySelector("script[nonce]"))==null?void 0:M.nonce)||"",j.head.append(n)}));S[O]?console.warn(f+" only loads once. Ignoring:",t):S[O]=(P,...v)=>T.add(P)&&R().then(()=>S[O](P,...v))}_createPACStructure(){const t=document.createElement("section");e(this,s).classes.section.split(" ").forEach(f=>f&&t.classList.add(f)),h(this,p,document.createElement("div")),e(this,p).className=e(this,s).classes.container,e(this,p).setAttribute("id",e(this,x)+"-div"),t.appendChild(e(this,p));const a=document.createElement("div");a.className=e(this,s).classes.icon_container,e(this,p).appendChild(a);const n=document.createElement("div");if(n.innerHTML=e(this,s).classes.icon,a.appendChild(n.firstElementChild),h(this,i,document.createElement("input")),e(this,i).id=e(this,x)+"-input",e(this,i).type="text",e(this,i).name="search",e(this,i).placeholder=e(this,s).placeholder,e(this,i).autocomplete=e(this,s).autocomplete,e(this,i).className=e(this,s).classes.input,e(this,i).setAttribute("role","combobox"),e(this,i).setAttribute("aria-autocomplete","list"),e(this,i).setAttribute("aria-expanded","false"),e(this,i).setAttribute("aria-controls","pacSuggestions"),e(this,s).autofocus&&(e(this,i).autofocus=!0),e(this,s).label){const f=document.createElement("label");f.htmlFor=e(this,x)+"-labelInput",f.textContent=e(this,s).label,e(this,p).appendChild(f)}e(this,p).appendChild(e(this,i));const r=document.createElement("div");r.className=e(this,s).classes.kbd_container,h(this,b,document.createElement("kbd")),e(this,b).className=e(this,s).classes.kbd_escape,e(this,b).textContent="Esc",r.appendChild(e(this,b)),h(this,_,document.createElement("kbd")),e(this,_).className=e(this,s).classes.kbd_up,e(this,_).innerHTML="&#8593;",r.appendChild(e(this,_)),h(this,y,document.createElement("kbd")),e(this,y).className=e(this,s).classes.kbd_down,e(this,y).innerHTML="&#8595;",r.appendChild(e(this,y)),e(this,p).appendChild(r),h(this,c,document.createElement("ul")),e(this,c).id="pacSuggestions",e(this,c).className=e(this,s).classes.ul,e(this,c).style.display="none",e(this,c).setAttribute("role","listbox"),e(this,p).appendChild(e(this,c)),e(this,E).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,i)?(e(this,i).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,i).addEventListener("blur",()=>{setTimeout(()=>{e(this,c)&&!e(this,c).contains(document.activeElement)&&(e(this,c).style.display="none",e(this,i).setAttribute("aria-expanded","false"))},200)}),e(this,i).addEventListener("focus",()=>{e(this,i).value&&e(this,g).length>0&&(e(this,c).style.display="block",e(this,i).setAttribute("aria-expanded","true"))})):e(this,k).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,k).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1,a=null){h(this,m,-1),e(this,i)&&e(this,s).clear_input==!1&&a&&a.formattedAddress?e(this,i).value=a.formattedAddress:e(this,i)&&(e(this,i).value=""),e(this,i)&&(e(this,i).setAttribute("aria-expanded","false"),e(this,i).blur()),h(this,g,[]),h(this,m,-1),e(this,c)&&(e(this,c).innerHTML="",e(this,c).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,c)&&Array.from(e(this,c).children).forEach(t=>{e(this,s).classes.li_current.split(" ").forEach(n=>t.classList.remove(n));const a=t.querySelector("a");a&&e(this,s).classes.li_a_current.split(" ").forEach(n=>a.classList.remove(n))})}_onKeyDown(t){if(this._resetLiClasses(),t.key==="Escape"&&(t.preventDefault(),e(this,s).classes.kbd_active.split(" ").forEach(a=>{var n;return(n=e(this,b))==null?void 0:n.classList.add(a)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(a=>{var n;return(n=e(this,b))==null?void 0:n.classList.remove(a)}),300),this._reset(!0)),!(!e(this,g).length||!e(this,c)||e(this,c).style.display==="none"))if(t.key==="ArrowDown"){t.preventDefault(),h(this,m,Math.min(e(this,m)+1,e(this,g).length-1)),e(this,m)<0&&h(this,m,0);const a=e(this,c).children.item(e(this,m));if(a){const n=a.querySelector("a");e(this,s).classes.li_current.split(" ").forEach(r=>a.classList.add(r)),n&&e(this,s).classes.li_a_current.split(" ").forEach(r=>n.classList.add(r)),a.scrollIntoView({block:"nearest"})}e(this,s).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,y))==null?void 0:r.classList.add(n)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,y))==null?void 0:r.classList.remove(n)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),h(this,m,Math.max(e(this,m)-1,0));const a=e(this,c).children.item(e(this,m));if(a){const n=a.querySelector("a");e(this,s).classes.li_current.split(" ").forEach(r=>a.classList.add(r)),n&&e(this,s).classes.li_a_current.split(" ").forEach(r=>n.classList.add(r)),a.scrollIntoView({block:"nearest"})}e(this,s).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,_))==null?void 0:r.classList.add(n)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,_))==null?void 0:r.classList.remove(n)}),300)}else t.key==="Enter"&&(t.preventDefault(),e(this,m)>=0&&e(this,m)<e(this,g).length&&this._onPlaceSelected(e(this,g)[e(this,m)].place))}_createSuggestionElements(t){return h(this,g,[]),t.map((a,n)=>{e(this,g).push({id:n+1,description:a.placePrediction.toString(),place:a.placePrediction.toPlace()});const r=document.createElement("div");r.className=e(this,s).classes.li_div_container;const f=document.createElement("div");f.className=e(this,s).classes.li_div_one,r.appendChild(f);const w=document.createElement("p");w.className=e(this,s).classes.li_div_one_p;const O=a.placePrediction.text,N=O.text,j=O.matches;let L=0;j.sort((C,H)=>C.startOffset-H.startOffset);const S=document.createElement("span"),T=document.createElement("span");T.classList=e(this,s).classes.highlight??"font-bold";for(const C of j)S.textContent+=N.substring(L,C.startOffset),C.startOffset>0&&N.charAt(C.startOffset-1)==" "&&(T.textContent+=" "),T.textContent+=N.substring(C.startOffset,C.endOffset),L=C.endOffset;const D=document.createTextNode(N.substring(L));S.appendChild(T),S.appendChild(D),w.appendChild(S),f.appendChild(w),r.appendChild(f);const R=document.createElement("div");R.className=e(this,s).classes.li_div_two,r.appendChild(R);const P=document.createElement("p");P.className=e(this,s).classes.li_div_two_p,P.textContent=this._formatDistance(a.placePrediction.distanceMeters,e(this,s).distance_units??"km"),R.appendChild(P);const v=document.createElement("a");v.href="javascript:void(0)",v.tabIndex=n+1,v.className=e(this,s).classes.li_a,v.addEventListener("click",()=>{this._onPlaceSelected(a.placePrediction.toPlace())}),v.appendChild(r),v.appendChild(R);const M=document.createElement("li");return M.id=`option-${n+1}`,M.className=e(this,s).classes.li,M.appendChild(v),M})}async _onPlaceSelected(t){let a=null;try{await t.fetchFields({fields:e(this,I)}),a=t.toJSON(),e(this,K).call(this,a)}catch(n){console.error("Error fetching place details:",n),e(this,k).call(this,n)}finally{this._reset(!0,a)}}_refreshToken(){try{e(this,A).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,k).call(this,t)}}setFetchFields(t){this._setFetchFields(t)}getFetchFields(){return e(this,I)}setRequestParams(t){typeof t=="object"&&!Array.isArray(t)&&t!==null&&(t.input&&typeof t.input=="string"&&(e(this,i).value=t.input),h(this,A,{...e(this,q),...t}))}getRequestParams(){return e(this,A)}setOptions(t){if(typeof t=="object"&&!Array.isArray(t)&&t!==null){const a=t.classes||{};if(delete t.classes,h(this,s,{...e(this,$),...t}),e(this,i).placeholder=e(this,s).placeholder,e(this,i).autocomplete=e(this,s).autocomplete,e(this,i).autofocus=e(this,s).autofocus,e(this,i).debounce=e(this,s).debounce,e(this,i).clear_input=e(this,s).clear_input,e(this,i).distance=e(this,s).distance,e(this,i).distance_units=e(this,s).distance_units,e(this,i).label=e(this,s).label,e(this,i).setAttribute("aria-label",e(this,s).label||"Search for places"),e(this,i).setAttribute("aria-autocomplete",e(this,s).aria_autocomplete||"list"),e(this,i).setAttribute("aria-expanded",e(this,s).aria_expanded||"false"),e(this,i).setAttribute("aria-controls",e(this,s).aria_controls||"pacSuggestions"),e(this,i).setAttribute("role",e(this,s).role||"combobox"),e(this,i).setAttribute("aria-required",e(this,s).aria_required||"false"),e(this,i).setAttribute("aria-activedescendant",e(this,s).aria_activedescendant||""),a&&typeof a=="object"&&Object.keys(a).length>0&&(e(this,s).classes={...e(this,F),...a}),e(this,p)&&(e(this,p).className=e(this,s).classes.container),e(this,i)&&(e(this,i).className=e(this,s).classes.input),e(this,c)&&(e(this,c).className=e(this,s).classes.ul),e(this,b)&&(e(this,b).className=e(this,s).classes.kbd_escape),e(this,_)&&(e(this,_).className=e(this,s).classes.kbd_up),e(this,y)&&(e(this,y).className=e(this,s).classes.kbd_down),e(this,E)){const n=e(this,E).querySelector("section");n&&e(this,s).classes.section.split(" ").forEach(r=>r&&n.classList.add(r))}}}getOptions(){return e(this,s)}clear(){this._reset(!0)}destroy(){e(this,i)&&e(this,i).removeEventListener("input",this._debouncedMakeAcRequest),e(this,E)&&e(this,p)&&e(this,E).removeChild(e(this,p).parentElement);for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}x=new WeakMap,E=new WeakMap,z=new WeakMap,G=new WeakMap,s=new WeakMap,A=new WeakMap,i=new WeakMap,p=new WeakMap,c=new WeakMap,b=new WeakMap,_=new WeakMap,y=new WeakMap,g=new WeakMap,m=new WeakMap,K=new WeakMap,k=new WeakMap,$=new WeakMap,F=new WeakMap,q=new WeakMap,I=new WeakMap,B=new WeakMap,l.PlacesAutocomplete=o,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
