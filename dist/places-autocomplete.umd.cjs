(function(o,l){typeof exports=="object"&&typeof module<"u"?l(exports):typeof define=="function"&&define.amd?define(["exports"],l):(o=typeof globalThis<"u"?globalThis:o||self,l(o.PlacesAutocomplete={}))})(this,function(o){"use strict";var U=Object.defineProperty;var H=o=>{throw TypeError(o)};var Z=(o,l,d)=>l in o?U(o,l,{enumerable:!0,configurable:!0,writable:!0,value:d}):o[l]=d;var V=(o,l,d)=>Z(o,typeof l!="symbol"?l+"":l,d),J=(o,l,d)=>l.has(o)||H("Cannot "+d);var e=(o,l,d)=>(J(o,l,"read from private field"),d?d.call(o):l.get(o)),u=(o,l,d)=>l.has(o)?H("Cannot add the same private member more than once"):l instanceof WeakSet?l.add(o):l.set(o,d),c=(o,l,d,_)=>(J(o,l,"write to private field"),_?_.call(o,d):l.set(o,d),d);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var d,_,R,z,i,b,a,f,h,w,k,A,g,p,G,v,K,S,F,I,$;class l{constructor(t){u(this,d);u(this,_);u(this,R);u(this,z);u(this,i);u(this,b);u(this,a);u(this,f);u(this,h);u(this,w);u(this,k);u(this,A);u(this,g,[]);u(this,p,-1);u(this,G);u(this,v);V(this,"_debouncedMakeAcRequest");u(this,K,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,clear_input:!0,debug:!1});u(this,S,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});u(this,F,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});u(this,I,["formattedAddress","addressComponents"]);u(this,$,["formattedAddress","addressComponents"]);if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(c(this,d,t.containerId),c(this,_,document.getElementById(t.containerId)),!e(this,_))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);c(this,R,t.googleMapsApiKey),c(this,z,t.googleMapsApiVersion||"weekly"),c(this,i,{...e(this,K),...t.options}),t.options&&t.options.classes?e(this,i).classes={...e(this,S),...t.options.classes}:e(this,i).classes=e(this,S),e(this,i).debug&&(console.log("___debug constructor options:"),console.log(e(this,i))),t.fetchFields&&Array.isArray(t.fetchFields)&&this._setFetchFields(t.fetchFields),c(this,G,t.onResponse||(s=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(s,null,2))})),c(this,v,t.onError||(s=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",s)})),t.requestParams&&Object.keys(t.requestParams).length>0?c(this,b,{...e(this,F),...t.requestParams}):c(this,b,{...e(this,F)}),e(this,i).debug&&console.log("___debug constructor requestParams:",e(this,b)),this._initialiseDebouncedRequest(),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,R),v:e(this,z)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,v).call(this,t)}}_initialiseDebouncedRequest(){this._debouncedMakeAcRequest=this._debounce(async()=>{if(!e(this,a)||!e(this,a).value){this._reset(),e(this,a)&&e(this,a).setAttribute("aria-expanded","false");return}e(this,b).input=e(this,a).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,b));t&&t.length>0?(e(this,h).replaceChildren(...this._createSuggestionElements(t)),e(this,h).style.display="block",e(this,a).setAttribute("aria-expanded","true")):(this._reset(),e(this,a).setAttribute("aria-expanded","false"))}catch(t){e(this,v).call(this,t),this._reset()}},e(this,i).debounce)}_setFetchFields(t){Array.isArray(t)&&t.length>0&&c(this,I,[...new Set([...e(this,$),...t])].filter(s=>s))}_debounce(t,s){e(this,i).debug&&console.log("___debug debounce function called with wait:",s);let n=null;return function(...m){const E=()=>{n=null,t(...m)};n!==null&&clearTimeout(n),n=setTimeout(E,s??100)}}_formatDistance(t,s){if(typeof t!="number"||!e(this,i).distance)return null;let n,r;return s==="km"?(n=(t/1e3).toFixed(2),r="km"):(n=(t/1609.34).toFixed(2),r="miles"),n=n.replace(/\.00$/,""),`${n} ${r}`}async _loadGoogleMapsApi(t){var s,n,r,m="The Google Maps JavaScript API",E="google",N="importLibrary",M="__ib__",O=document,C=window;C=C[E]||(C[E]={});var L=C.maps||(C.maps={}),T=new Set,j=new URLSearchParams,D=()=>s||(s=new Promise(async(P,y)=>{var q;n=O.createElement("script"),j.set("libraries",[...T].join(","));for(r in t)j.set(r.replace(/[A-Z]/g,x=>"_"+x[0].toLowerCase()),t[r]);j.set("callback",E+".maps."+M),n.src=`https://maps.${E}apis.com/maps/api/js?`+j,L[M]=P,n.onerror=()=>s=y(Error(m+" could not load.")),n.nonce=((q=O.querySelector("script[nonce]"))==null?void 0:q.nonce)||"",O.head.append(n)}));L[N]?console.warn(m+" only loads once. Ignoring:",t):L[N]=(P,...y)=>T.add(P)&&D().then(()=>L[N](P,...y))}_createPACStructure(){const t=document.createElement("section");e(this,i).classes.section.split(" ").forEach(m=>m&&t.classList.add(m)),c(this,f,document.createElement("div")),e(this,f).className=e(this,i).classes.container,e(this,f).setAttribute("id",e(this,d)+"-div"),t.appendChild(e(this,f));const s=document.createElement("div");s.className=e(this,i).classes.icon_container,e(this,f).appendChild(s);const n=document.createElement("div");if(n.innerHTML=e(this,i).classes.icon,s.appendChild(n.firstElementChild),c(this,a,document.createElement("input")),e(this,a).id=e(this,d)+"-input",e(this,a).type="text",e(this,a).name="search",e(this,a).placeholder=e(this,i).placeholder,e(this,a).autocomplete=e(this,i).autocomplete,e(this,a).className=e(this,i).classes.input,e(this,a).setAttribute("role","combobox"),e(this,a).setAttribute("aria-autocomplete","list"),e(this,a).setAttribute("aria-expanded","false"),e(this,a).setAttribute("aria-controls","pacSuggestions"),e(this,i).autofocus&&(e(this,a).autofocus=!0),e(this,i).label){const m=document.createElement("label");m.htmlFor=e(this,d)+"-labelInput",m.textContent=e(this,i).label,e(this,f).appendChild(m)}e(this,f).appendChild(e(this,a));const r=document.createElement("div");r.className=e(this,i).classes.kbd_container,c(this,w,document.createElement("kbd")),e(this,w).className=e(this,i).classes.kbd_escape,e(this,w).textContent="Esc",r.appendChild(e(this,w)),c(this,k,document.createElement("kbd")),e(this,k).className=e(this,i).classes.kbd_up,e(this,k).innerHTML="&#8593;",r.appendChild(e(this,k)),c(this,A,document.createElement("kbd")),e(this,A).className=e(this,i).classes.kbd_down,e(this,A).innerHTML="&#8595;",r.appendChild(e(this,A)),e(this,f).appendChild(r),c(this,h,document.createElement("ul")),e(this,h).id="pacSuggestions",e(this,h).className=e(this,i).classes.ul,e(this,h).style.display="none",e(this,h).setAttribute("role","listbox"),e(this,f).appendChild(e(this,h)),e(this,_).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}_attachedEventListeners(){e(this,a).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,a).addEventListener("blur",()=>{setTimeout(()=>{e(this,h)&&!e(this,h).contains(document.activeElement)&&(e(this,h).style.display="none",e(this,a).setAttribute("aria-expanded","false"))},200)}),e(this,a).addEventListener("focus",()=>{e(this,a).value&&e(this,g).length>0&&(e(this,h).style.display="block",e(this,a).setAttribute("aria-expanded","true"))})}_detachEventListeners(){e(this,a)&&e(this,a).removeEventListener("input",this._debouncedMakeAcRequest),e(this,_)&&e(this,f)&&e(this,_).removeChild(e(this,f).parentElement)}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,a)?this._attachedEventListeners():e(this,v).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,v).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1,s=null){c(this,p,-1),e(this,a)&&e(this,i).clear_input==!1&&s&&s.formattedAddress?e(this,a).value=s.formattedAddress:e(this,a)&&(e(this,a).value=""),e(this,a)&&(e(this,a).setAttribute("aria-expanded","false"),e(this,a).blur()),c(this,g,[]),c(this,p,-1),e(this,h)&&(e(this,h).innerHTML="",e(this,h).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,h)&&Array.from(e(this,h).children).forEach(t=>{e(this,i).classes.li_current.split(" ").forEach(n=>t.classList.remove(n));const s=t.querySelector("a");s&&e(this,i).classes.li_a_current.split(" ").forEach(n=>s.classList.remove(n))})}_onKeyDown(t){if(this._resetLiClasses(),t.key==="Escape"&&(t.preventDefault(),e(this,i).classes.kbd_active.split(" ").forEach(s=>{var n;return(n=e(this,w))==null?void 0:n.classList.add(s)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(s=>{var n;return(n=e(this,w))==null?void 0:n.classList.remove(s)}),300),this._reset(!0)),!(!e(this,g).length||!e(this,h)||e(this,h).style.display==="none"))if(t.key==="ArrowDown"){t.preventDefault(),c(this,p,Math.min(e(this,p)+1,e(this,g).length-1)),e(this,p)<0&&c(this,p,0);const s=e(this,h).children.item(e(this,p));if(s){const n=s.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(r=>s.classList.add(r)),n&&e(this,i).classes.li_a_current.split(" ").forEach(r=>n.classList.add(r)),s.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,A))==null?void 0:r.classList.add(n)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,A))==null?void 0:r.classList.remove(n)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),c(this,p,Math.max(e(this,p)-1,0));const s=e(this,h).children.item(e(this,p));if(s){const n=s.querySelector("a");e(this,i).classes.li_current.split(" ").forEach(r=>s.classList.add(r)),n&&e(this,i).classes.li_a_current.split(" ").forEach(r=>n.classList.add(r)),s.scrollIntoView({block:"nearest"})}e(this,i).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,k))==null?void 0:r.classList.add(n)}),setTimeout(()=>e(this,i).classes.kbd_active.split(" ").forEach(n=>{var r;return(r=e(this,k))==null?void 0:r.classList.remove(n)}),300)}else t.key==="Enter"&&(t.preventDefault(),e(this,p)>=0&&e(this,p)<e(this,g).length&&this._onPlaceSelected(e(this,g)[e(this,p)].place))}_createSuggestionElements(t){return c(this,g,[]),t.map((s,n)=>{e(this,g).push({id:n+1,description:s.placePrediction.toString(),place:s.placePrediction.toPlace()});const r=document.createElement("div");r.className=e(this,i).classes.li_div_container;const m=document.createElement("div");m.className=e(this,i).classes.li_div_one,r.appendChild(m);const E=document.createElement("p");E.className=e(this,i).classes.li_div_one_p;const N=s.placePrediction.text,M=N.text,O=N.matches;let C=0;O.sort((x,B)=>x.startOffset-B.startOffset);const L=document.createElement("span"),T=document.createElement("span");T.classList=e(this,i).classes.highlight??"font-bold";for(const x of O)L.textContent+=M.substring(C,x.startOffset),x.startOffset>0&&M.charAt(x.startOffset-1)==" "&&(T.textContent+=" "),T.textContent+=M.substring(x.startOffset,x.endOffset),C=x.endOffset;const j=document.createTextNode(M.substring(C));L.appendChild(T),L.appendChild(j),E.appendChild(L),m.appendChild(E),r.appendChild(m);const D=document.createElement("div");D.className=e(this,i).classes.li_div_two,r.appendChild(D);const P=document.createElement("p");P.className=e(this,i).classes.li_div_two_p,P.textContent=this._formatDistance(s.placePrediction.distanceMeters,e(this,i).distance_units??"km"),D.appendChild(P);const y=document.createElement("a");y.href="javascript:void(0)",y.tabIndex=n+1,y.className=e(this,i).classes.li_a,y.addEventListener("click",()=>{this._onPlaceSelected(s.placePrediction.toPlace())}),y.appendChild(r),y.appendChild(D);const q=document.createElement("li");return q.id=`option-${n+1}`,q.className=e(this,i).classes.li,q.appendChild(y),q})}async _onPlaceSelected(t){let s=null;try{await t.fetchFields({fields:e(this,I)}),s=t.toJSON(),e(this,G).call(this,s)}catch(n){console.error("Error fetching place details:",n),e(this,v).call(this,n)}finally{this._reset(!0,s)}}_refreshToken(){try{e(this,b).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,v).call(this,t)}}setFetchFields(t){this._setFetchFields(t)}getFetchFields(){return e(this,I)}setRequestParams(t){typeof t=="object"&&!Array.isArray(t)&&t!==null&&(t.input&&typeof t.input=="string"&&(e(this,a).value=t.input),c(this,b,{...e(this,F),...t}))}getRequestParams(){return e(this,b)}setOptions(t){if(typeof t=="object"&&!Array.isArray(t)&&t!==null){this._detachEventListeners();const s=t.classes||{};delete t.classes,c(this,i,{...e(this,K),...t}),s&&typeof s=="object"&&Object.keys(s).length>0?e(this,i).classes={...e(this,S),...s}:e(this,i).classes={...e(this,S)},this._initialiseDebouncedRequest(),this._createPACStructure(),e(this,a)&&this._attachedEventListeners()}}getOptions(){return e(this,i)}clear(){this._reset(!0)}destroy(){this._detachEventListeners();for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}d=new WeakMap,_=new WeakMap,R=new WeakMap,z=new WeakMap,i=new WeakMap,b=new WeakMap,a=new WeakMap,f=new WeakMap,h=new WeakMap,w=new WeakMap,k=new WeakMap,A=new WeakMap,g=new WeakMap,p=new WeakMap,G=new WeakMap,v=new WeakMap,K=new WeakMap,S=new WeakMap,F=new WeakMap,I=new WeakMap,$=new WeakMap,o.PlacesAutocomplete=l,Object.defineProperty(o,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
