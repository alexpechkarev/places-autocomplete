(function(l,o){typeof exports=="object"&&typeof module<"u"?o(exports):typeof define=="function"&&define.amd?define(["exports"],o):(l=typeof globalThis<"u"?globalThis:l||self,o(l.PlacesAutocomplete={}))})(this,function(l){"use strict";var Z=Object.defineProperty;var V=l=>{throw TypeError(l)};var Q=(l,o,p)=>o in l?Z(l,o,{enumerable:!0,configurable:!0,writable:!0,value:p}):l[o]=p;var J=(l,o,p)=>Q(l,typeof o!="symbol"?o+"":o,p),U=(l,o,p)=>o.has(l)||V("Cannot "+p);var e=(l,o,p)=>(U(l,o,"read from private field"),p?p.call(l):o.get(l)),d=(l,o,p)=>o.has(l)?V("Cannot add the same private member more than once"):o instanceof WeakSet?o.add(l):o.set(l,p),h=(l,o,p,w)=>(U(l,o,"write to private field"),w?w.call(l,p):o.set(l,p),p);/**
 * Initializes a Places Autocomplete widget.
 * This script dynamically loads the Google Maps JavaScript API, creates the UI elements
 * for the autocomplete input and suggestions list, handles user input with debouncing,
 * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks
 * on place selection or error.
 *
 * @author Alexander Pechkarev <alexpechkarev@gmail.com>
 * @license MIT
 *
 */var p,w,C,z,G,s,L,i,m,c,g,v,x,k,f,K,S,$,I,O,j,B;class o{constructor(t){d(this,w);d(this,C);d(this,z);d(this,G);d(this,s);d(this,L);d(this,i);d(this,m);d(this,c);d(this,g);d(this,v);d(this,x);d(this,k,[]);d(this,f,-1);d(this,K);d(this,S);d(this,$,{autofocus:!1,autocomplete:"off",placeholder:"Start typing your address ...",distance:!0,distance_units:"km",label:"",debounce:100,clear_input:!0});d(this,I,{section:"",container:"relative z-10 transform rounded-xl mt-4",icon_container:"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3",icon:'<svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="11" cy="11" r="8" /><path d="m21 21-4.3-4.3" /></svg>',input:"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm",kbd_container:"absolute inset-y-0 right-0 flex py-1.5 pr-1.5",kbd_escape:"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1",kbd_up:"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6",kbd_down:"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6",kbd_active:"bg-indigo-500 text-white",ul:"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100",li:"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white",li_current:"bg-indigo-500",li_a:"block w-full flex justify-between",li_a_current:"text-white",li_div_container:"flex min-w-0 gap-x-4",li_div_one:"min-w-0 flex-auto",li_div_one_p:"text-sm/6",li_div_two:"shrink-0 flex flex-col items-end min-w-16",li_div_two_p:"mt-1 text-xs/5",highlight:"font-bold"});d(this,O,{input:"",includedRegionCodes:["GB"],language:"en-gb",region:"GB"});d(this,j,["formattedAddress","addressComponents"]);d(this,B,["formattedAddress","addressComponents"]);J(this,"_debouncedMakeAcRequest",this._debounce(async()=>{if(!e(this,i)||!e(this,i).value){this._reset(),e(this,i)&&e(this,i).setAttribute("aria-expanded","false");return}e(this,L).input=e(this,i).value;try{const{suggestions:t}=await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(e(this,L));t&&t.length>0?(e(this,c).replaceChildren(...this._createSuggestionElements(t)),e(this,c).style.display="block",e(this,i).setAttribute("aria-expanded","true")):(this._reset(),e(this,i).setAttribute("aria-expanded","false"))}catch(t){e(this,S).call(this,t),this._reset()}},((p=e(this,s))==null?void 0:p.debounce)??100));if(!t||!t.containerId||!t.googleMapsApiKey)throw new Error("PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).");if(h(this,w,t.containerId),h(this,C,document.getElementById(t.containerId)),!e(this,C))throw new Error(`PacAutocomplete: Container element with ID "${t.containerId}" not found.`);h(this,z,t.googleMapsApiKey),h(this,G,t.googleMapsApiVersion||"weekly"),h(this,s,{...e(this,$),...t.options}),t.options&&t.options.classes?e(this,s).classes={...e(this,I),...t.options.classes}:e(this,s).classes=e(this,I),t.fetchFields&&Array.isArray(t.fetchFields)&&this._setFetchFields(t.fetchFields),h(this,K,t.onResponse||(n=>{console.info("---------Default onResponse not provided---------"),console.info("Selected Place:",JSON.stringify(n,null,2))})),h(this,S,t.onError||(n=>{console.error("---------Default onError not provided---------"),console.error("PAC Error:",n)})),t.requestParams&&Object.keys(t.requestParams).length>0?h(this,L,{...e(this,O),...t.requestParams}):h(this,L,{...e(this,O)}),this._init()}async _init(){try{(typeof google>"u"||!google.maps)&&await this._loadGoogleMapsApi({key:e(this,z),v:e(this,G)}),this._createPACStructure(),await this._initializeAutocomplete()}catch(t){e(this,S).call(this,t)}}_setFetchFields(t){Array.isArray(t)&&t.length>0&&h(this,j,[...new Set([...e(this,B),...t])].filter(n=>n))}_debounce(t,n){let a=null;return function(...u){const b=()=>{a=null,t(...u)};a!==null&&clearTimeout(a),a=setTimeout(b,n??100)}}_formatDistance(t,n){if(typeof t!="number"||!e(this,s).distance)return null;let a,r;return n==="km"?(a=(t/1e3).toFixed(2),r="km"):(a=(t/1609.34).toFixed(2),r="miles"),a=a.replace(/\.00$/,""),`${a} ${r}`}async _loadGoogleMapsApi(t){var n,a,r,u="The Google Maps JavaScript API",b="google",T="importLibrary",P="__ib__",E=document,_=window;_=_[b]||(_[b]={});var y=_.maps||(_.maps={}),F=new Set,D=new URLSearchParams,R=()=>n||(n=new Promise(async(M,A)=>{var q;a=E.createElement("script"),D.set("libraries",[...F].join(","));for(r in t)D.set(r.replace(/[A-Z]/g,N=>"_"+N[0].toLowerCase()),t[r]);D.set("callback",b+".maps."+P),a.src=`https://maps.${b}apis.com/maps/api/js?`+D,y[P]=M,a.onerror=()=>n=A(Error(u+" could not load.")),a.nonce=((q=E.querySelector("script[nonce]"))==null?void 0:q.nonce)||"",E.head.append(a)}));y[T]?console.warn(u+" only loads once. Ignoring:",t):y[T]=(M,...A)=>F.add(M)&&R().then(()=>y[T](M,...A))}_createPACStructure(){const t=document.createElement("section");e(this,s).classes.section.split(" ").forEach(u=>u&&t.classList.add(u)),h(this,m,document.createElement("div")),e(this,m).className=e(this,s).classes.container,e(this,m).setAttribute("id",e(this,w)+"-div"),t.appendChild(e(this,m));const n=document.createElement("div");n.className=e(this,s).classes.icon_container,e(this,m).appendChild(n);const a=document.createElement("div");if(a.innerHTML=e(this,s).classes.icon,n.appendChild(a.firstElementChild),h(this,i,document.createElement("input")),e(this,i).id=e(this,w)+"-input",e(this,i).type="text",e(this,i).name="search",e(this,i).placeholder=e(this,s).placeholder,e(this,i).autocomplete=e(this,s).autocomplete,e(this,i).className=e(this,s).classes.input,e(this,i).setAttribute("role","combobox"),e(this,i).setAttribute("aria-autocomplete","list"),e(this,i).setAttribute("aria-expanded","false"),e(this,i).setAttribute("aria-controls","pacSuggestions"),e(this,s).autofocus&&(e(this,i).autofocus=!0),e(this,s).label){const u=document.createElement("label");u.htmlFor=e(this,w)+"-labelInput",u.textContent=e(this,s).label,e(this,m).appendChild(u)}e(this,m).appendChild(e(this,i));const r=document.createElement("div");r.className=e(this,s).classes.kbd_container,h(this,g,document.createElement("kbd")),e(this,g).className=e(this,s).classes.kbd_escape,e(this,g).textContent="Esc",r.appendChild(e(this,g)),h(this,v,document.createElement("kbd")),e(this,v).className=e(this,s).classes.kbd_up,e(this,v).innerHTML="&#8593;",r.appendChild(e(this,v)),h(this,x,document.createElement("kbd")),e(this,x).className=e(this,s).classes.kbd_down,e(this,x).innerHTML="&#8595;",r.appendChild(e(this,x)),e(this,m).appendChild(r),h(this,c,document.createElement("ul")),e(this,c).id="pacSuggestions",e(this,c).className=e(this,s).classes.ul,e(this,c).style.display="none",e(this,c).setAttribute("role","listbox"),e(this,m).appendChild(e(this,c)),e(this,C).appendChild(t),t.addEventListener("keydown",this._onKeyDown.bind(this))}async _initializeAutocomplete(){try{await google.maps.importLibrary("places"),this._refreshToken(),e(this,i)?(e(this,i).addEventListener("input",this._debouncedMakeAcRequest.bind(this)),e(this,i).addEventListener("blur",()=>{setTimeout(()=>{e(this,c)&&!e(this,c).contains(document.activeElement)&&(e(this,c).style.display="none",e(this,i).setAttribute("aria-expanded","false"))},200)}),e(this,i).addEventListener("focus",()=>{e(this,i).value&&e(this,k).length>0&&(e(this,c).style.display="block",e(this,i).setAttribute("aria-expanded","true"))})):e(this,S).call(this,new Error("Input element not found during initialization."))}catch(t){console.error("Error initializing Google Places Autocomplete:",t),e(this,S).call(this,new Error("Google Maps Places library not available."))}}_reset(t=!1,n=null){h(this,f,-1),e(this,i)&&e(this,s).clear_input==!1&&n&&n.formattedAddress?e(this,i).value=n.formattedAddress:e(this,i)&&(e(this,i).value=""),e(this,i)&&(e(this,i).setAttribute("aria-expanded","false"),e(this,i).blur()),h(this,k,[]),h(this,f,-1),e(this,c)&&(e(this,c).innerHTML="",e(this,c).style.display="none"),t&&this._refreshToken()}_resetLiClasses(){e(this,c)&&Array.from(e(this,c).children).forEach(t=>{e(this,s).classes.li_current.split(" ").forEach(a=>t.classList.remove(a));const n=t.querySelector("a");n&&e(this,s).classes.li_a_current.split(" ").forEach(a=>n.classList.remove(a))})}_onKeyDown(t){if(this._resetLiClasses(),t.key==="Escape"&&(t.preventDefault(),e(this,s).classes.kbd_active.split(" ").forEach(n=>{var a;return(a=e(this,g))==null?void 0:a.classList.add(n)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(n=>{var a;return(a=e(this,g))==null?void 0:a.classList.remove(n)}),300),this._reset(!0)),!(!e(this,k).length||!e(this,c)||e(this,c).style.display==="none"))if(t.key==="ArrowDown"){t.preventDefault(),h(this,f,Math.min(e(this,f)+1,e(this,k).length-1)),e(this,f)<0&&h(this,f,0);const n=e(this,c).children.item(e(this,f));if(n){const a=n.querySelector("a");e(this,s).classes.li_current.split(" ").forEach(r=>n.classList.add(r)),a&&e(this,s).classes.li_a_current.split(" ").forEach(r=>a.classList.add(r)),n.scrollIntoView({block:"nearest"})}e(this,s).classes.kbd_active.split(" ").forEach(a=>{var r;return(r=e(this,x))==null?void 0:r.classList.add(a)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(a=>{var r;return(r=e(this,x))==null?void 0:r.classList.remove(a)}),300)}else if(t.key==="ArrowUp"){t.preventDefault(),h(this,f,Math.max(e(this,f)-1,0));const n=e(this,c).children.item(e(this,f));if(n){const a=n.querySelector("a");e(this,s).classes.li_current.split(" ").forEach(r=>n.classList.add(r)),a&&e(this,s).classes.li_a_current.split(" ").forEach(r=>a.classList.add(r)),n.scrollIntoView({block:"nearest"})}e(this,s).classes.kbd_active.split(" ").forEach(a=>{var r;return(r=e(this,v))==null?void 0:r.classList.add(a)}),setTimeout(()=>e(this,s).classes.kbd_active.split(" ").forEach(a=>{var r;return(r=e(this,v))==null?void 0:r.classList.remove(a)}),300)}else t.key==="Enter"&&(t.preventDefault(),e(this,f)>=0&&e(this,f)<e(this,k).length&&this._onPlaceSelected(e(this,k)[e(this,f)].place))}_createSuggestionElements(t){return h(this,k,[]),t.map((n,a)=>{e(this,k).push({id:a+1,description:n.placePrediction.toString(),place:n.placePrediction.toPlace()});const r=document.createElement("div");r.className=e(this,s).classes.li_div_container;const u=document.createElement("div");u.className=e(this,s).classes.li_div_one,r.appendChild(u);const b=document.createElement("p");b.className=e(this,s).classes.li_div_one_p;const T=n.placePrediction.text,P=T.text,E=T.matches;let _=0;E.sort((N,H)=>N.startOffset-H.startOffset);const y=document.createElement("span"),F=document.createElement("span");F.classList=e(this,s).classes.highlight??"font-bold";for(const N of E)y.textContent+=P.substring(_,N.startOffset),N.startOffset>0&&P.charAt(N.startOffset-1)==" "&&(F.textContent+=" "),F.textContent+=P.substring(N.startOffset,N.endOffset),_=N.endOffset;const D=document.createTextNode(P.substring(_));y.appendChild(F),y.appendChild(D),b.appendChild(y),u.appendChild(b),r.appendChild(u);const R=document.createElement("div");R.className=e(this,s).classes.li_div_two,r.appendChild(R);const M=document.createElement("p");M.className=e(this,s).classes.li_div_two_p,M.textContent=this._formatDistance(n.placePrediction.distanceMeters,e(this,s).distance_units??"km"),R.appendChild(M);const A=document.createElement("a");A.href="javascript:void(0)",A.tabIndex=a+1,A.className=e(this,s).classes.li_a,A.addEventListener("click",()=>{this._onPlaceSelected(n.placePrediction.toPlace())}),A.appendChild(r),A.appendChild(R);const q=document.createElement("li");return q.id=`option-${a+1}`,q.className=e(this,s).classes.li,q.appendChild(A),q})}async _onPlaceSelected(t){let n=null;try{await t.fetchFields({fields:e(this,j)}),n=t.toJSON(),e(this,K).call(this,n)}catch(a){console.error("Error fetching place details:",a),e(this,S).call(this,a)}finally{this._reset(!0,n)}}_refreshToken(){try{e(this,L).sessionToken=new google.maps.places.AutocompleteSessionToken}catch(t){console.error("Error creating session token:",t),e(this,S).call(this,t)}}setFetchFields(t){this._setFetchFields(t)}getFetchFields(){return e(this,j)}setRequestParams(t){typeof t=="object"&&!Array.isArray(t)&&t!==null&&(t.input&&typeof t.input=="string"&&(e(this,i).value=t.input),h(this,L,{...e(this,O),...t}))}getRequestParams(){return e(this,L)}setOptions(t){var n,a,r,u,b,T,P;if(typeof t=="object"&&!Array.isArray(t)&&t!==null){const E=t.classes||{};if(delete t.classes,h(this,s,{...e(this,$),...t}),e(this,i).placeholder=e(this,s).placeholder,e(this,i).autocomplete=e(this,s).autocomplete,e(this,i).autofocus=e(this,s).autofocus,e(this,i).debounce=e(this,s).debounce,e(this,i).clear_input=e(this,s).clear_input,e(this,i).distance=e(this,s).distance,e(this,i).distance_units=e(this,s).distance_units,e(this,i).label=e(this,s).label,e(this,i).setAttribute("aria-label",e(this,s).label||"Search for places"),e(this,i).setAttribute("aria-autocomplete",e(this,s).aria_autocomplete||"list"),e(this,i).setAttribute("aria-expanded",e(this,s).aria_expanded||"false"),e(this,i).setAttribute("aria-controls",e(this,s).aria_controls||"pacSuggestions"),e(this,i).setAttribute("role",e(this,s).role||"combobox"),e(this,i).setAttribute("aria-required",e(this,s).aria_required||"false"),e(this,i).setAttribute("aria-activedescendant",e(this,s).aria_activedescendant||""),E&&typeof E=="object"&&Object.keys(E).length>0&&(e(this,s).classes={...e(this,I),...E}),e(this,m)&&((n=e(this,s).classes)!=null&&n.container)&&(e(this,m).className=e(this,s).classes.container),e(this,i)&&((a=e(this,s).classes)!=null&&a.input)&&(e(this,i).className=e(this,s).classes.input),e(this,c)&&((r=e(this,s).classes)!=null&&r.ul)&&(e(this,c).className=e(this,s).classes.ul),e(this,g)&&((u=e(this,s).classes)!=null&&u.kbd_escape)&&(e(this,g).className=e(this,s).classes.kbd_escape),e(this,v)&&((b=e(this,s).classes)!=null&&b.kbd_up)&&(e(this,v).className=e(this,s).classes.kbd_up),e(this,x)&&((T=e(this,s).classes)!=null&&T.kbd_down)&&(e(this,x).className=e(this,s).classes.kbd_down),e(this,C)){const _=e(this,C).querySelector("section");_&&((P=e(this,s).classes)!=null&&P.section)&&e(this,s).classes.section.split(" ").forEach(y=>y&&_.classList.add(y))}}}getOptions(){return e(this,s)}clear(){this._reset(!0)}destroy(){e(this,i)&&e(this,i).removeEventListener("input",this._debouncedMakeAcRequest),e(this,C)&&e(this,m)&&e(this,C).removeChild(e(this,m).parentElement);for(const t in this)Object.hasOwn(this,t)&&(this[t]=null);console.log("PacAutocomplete instance destroyed.")}}w=new WeakMap,C=new WeakMap,z=new WeakMap,G=new WeakMap,s=new WeakMap,L=new WeakMap,i=new WeakMap,m=new WeakMap,c=new WeakMap,g=new WeakMap,v=new WeakMap,x=new WeakMap,k=new WeakMap,f=new WeakMap,K=new WeakMap,S=new WeakMap,$=new WeakMap,I=new WeakMap,O=new WeakMap,j=new WeakMap,B=new WeakMap,l.PlacesAutocomplete=o,Object.defineProperty(l,Symbol.toStringTag,{value:"Module"})});
//# sourceMappingURL=places-autocomplete.umd.cjs.map
