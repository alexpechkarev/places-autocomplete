{"version":3,"file":"places-autocomplete-js.umd.cjs","sources":["../lib/PlacesAutocompleteJs.js"],"sourcesContent":["/**\n * Initializes a Places Autocomplete widget.\n * This script dynamically loads the Google Maps JavaScript API, creates the UI elements\n * for the autocomplete input and suggestions list, handles user input with debouncing,\n * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks\n * on place selection or error.\n *\n * @author Alexander Pechkarev <alexpechkarev@gmail.com>\n * @license MIT\n *\n */\n\n/**\n * PacAutocomplete class\n * This class provides a Places Autocomplete widget.\n */\nexport class PlacesAutocompleteJs {\n  // --- Private Properties (using # or _ prefix by convention) ---\n  #pacEl;\n  #googleMapsApiKey;\n  #googleMapsApiVersion;\n  #options;\n  #request;\n  #inputElement;\n  #container;\n  #ul;\n  #kbdEscape;\n  #kbdUp;\n  #kbdDown;\n  #allSuggestions = [];\n  #currentSuggestion = -1;\n  #onDataCallback; // For user-provided data callback\n  #onErrorCallback; // For user-provided error callback\n  #defaultClasses = {\n    // CSS classes for various parts of the widget.\n    section: \"\", // Outer section container.\n    container: \"relative z-10 transform rounded-xl mt-4\", // Main container div.\n    icon_container:\n      \"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3\", // Container for the search icon.\n    icon: '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\" /><path d=\"m21 21-4.3-4.3\" /></svg>', // SVG for the search icon.\n    input:\n      \"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm\", // Input field.\n    kbd_container: \"absolute inset-y-0 right-0 flex py-1.5 pr-1.5\", // Container for keyboard hints.\n    kbd_escape:\n      \"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1\", // Escape key hint.\n    kbd_up:\n      \"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6\", // Up arrow key hint.\n    kbd_down:\n      \"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6\", // Down arrow key hint.\n    kbd_active: \"bg-indigo-500 text-white\", // Class for active keyboard hint.\n    ul: \"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100\", // Suggestions list (ul).\n    li: \"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white\", // Suggestion item (li).\n    li_current: \"bg-indigo-500\", // Class for the currently selected suggestion item.\n    li_a: \"block w-full flex justify-between\", // Link element within a suggestion item.\n    li_a_current: \"text-white\", // Class for the link in the currently selected suggestion item.\n    li_div_container: \"flex min-w-0 gap-x-4\", // Container div within the suggestion link.\n    li_div_one: \"min-w-0 flex-auto\", // First inner div (for place name).\n    li_div_one_p: \"text-sm/6\", // Paragraph for the place name.\n    li_div_two: \"shrink-0 flex flex-col items-end min-w-16\", // Second inner div (for distance).\n    li_div_two_p: \"mt-1 text-xs/5\", // Paragraph for the distance.\n    highlight: \"font-bold\", // Class for highlighting matched text in suggestions.\n  };\n\n  /**\n   * Class constructor for PacAutocomplete.\n   * Initializes the autocomplete widget with the provided configuration.\n   * @param {Object} config - Configuration object for the autocomplete widget.\n   * @param {string} config.containerId - ID of the container element for the widget.\n   * @param {string} config.googleMapsApiKey - Google Maps API key.\n   * @param {string} [config.googleMapsApiVersion] - Version of the Google Maps API to use (default: \"weekly\").\n   * @param {Object} [config.options] - Additional options for the widget (e.g., classes, callbacks).\n   * @param {Object} [config.requestParams] - Parameters for the autocomplete request (e.g., input, region).\n   * @param {*} config\n   */\n  constructor(config) {\n    //console.log(\"PacAutocomplete constructor called.\", config);\n    if (!config || !config.containerId || !config.googleMapsApiKey) {\n      throw new Error(\n        \"PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).\"\n      );\n    }\n\n    this.#pacEl = document.getElementById(config.containerId);\n    if (!this.#pacEl) {\n      throw new Error(\n        `PacAutocomplete: Container element with ID \"${config.containerId}\" not found.`\n      );\n    }\n\n    this.#googleMapsApiKey = config.googleMapsApiKey;\n    this.#googleMapsApiVersion = config.googleMapsApiVersion || \"weekly\";\n\n    // Merge user options with defaults\n    this.#options = {\n      autofocus: false, // Automatically focus the input on load.\n      autocomplete: \"off\", // HTML autocomplete attribute for the input.\n      placeholder: \"Start typing your address ...\", // Placeholder text for the input.\n      distance: true, // Show distance in suggestions (requires origin in request).\n      distance_units: \"km\", // Units for distance ('km' or 'miles').\n      label: \"\", // Optional label text above the input.\n      debounce: 100, // Debounce delay (ms) for API requests.\n      ...config.options, // User-defined options override defaults\n    };\n    // Ensure classes are deeply merged if user provides partial classes\n    if (config.options && config.options.classes) {\n      this.#options.classes = {\n        ...this.#defaultClasses,\n        ...config.options.classes,\n      };\n    }\n\n    // Set default response and error callbacks if not provided\n    this.#onDataCallback =\n      config.onResponse ||\n      ((place) => {\n        console.info(\"---------Default onResponse not provided---------\");\n        console.info(\"Selected Place:\", JSON.stringify(place, null, 2));\n      });\n    this.#onErrorCallback =\n      config.onError ||\n      ((error) => {\n        console.error(\"---------Default onError not provided---------\");\n        console.error(\"PAC Error:\", error);\n      });\n\n    this.#request = {\n      input: \"\",\n      includedRegionCodes: [\"GB\"],\n      language: \"en-gb\",\n      region: \"GB\",\n      ...config.requestParams, // User-defined request params override defaults\n    };\n\n    //console.log(this.#request);\n\n    this._init(); // Underscore prefix for internal initialization method\n  }\n\n  // --- Private Initialization Method ---\n  async _init() {\n    try {\n      // check if google maps api is already loaded\n      if (typeof google === \"undefined\" || !google.maps) {\n        // Load the Google Maps API dynamically\n        await this._loadGoogleMapsApi({\n          key: this.#googleMapsApiKey,\n          v: this.#googleMapsApiVersion,\n        });\n      }\n      this._createPACStructure(); // Pass this.#options\n      await this._initializeAutocomplete(); // Pass this.#options\n      //console.log(\"PacAutocomplete Initialized for container:\", this.#pacEl.id);\n    } catch (error) {\n      this.#onErrorCallback(error);\n    }\n  }\n\n  /**\n   * Creates a debounced version of a function.\n   * The debounced function delays invoking `func` until after `wait` milliseconds have\n   * elapsed since the last time the debounced function was invoked.\n   * @param {Function} func - The function to debounce.\n   * @param {number} wait - The number of milliseconds to delay.\n   * @returns {Function} The new debounced function.\n   */\n  _debounce(func, wait) {\n    let timeout = null;\n    return function executedFunction(...args) {\n      const later = () => {\n        timeout = null;\n        func(...args); // Call original function\n      };\n      if (timeout !== null) {\n        clearTimeout(timeout); // Clear the previous timeout\n      }\n      timeout = setTimeout(later, wait ?? 100); // Set the new timeout\n    };\n  }\n  /**\n   * Formats a distance in meters into kilometers or miles.\n   * @param {number | null | undefined} distance - Distance in meters.\n   * @param {'km' | 'miles'} units - The desired output units.\n   * @returns {string | null} Formatted distance string (e.g., \"1.23 km\") or null if input is invalid.\n   */\n  _formatDistance(distance, units) {\n    if (typeof distance !== \"number\" || !this.#options.distance) {\n      return null; // Return null if distance isn't shown or invalid\n    }\n    let value;\n    let unitLabel;\n    if (units === \"km\") {\n      value = (distance / 1000).toFixed(2);\n      unitLabel = \"km\";\n    } else {\n      // Default to miles if not 'km'\n      value = (distance / 1609.34).toFixed(2);\n      unitLabel = \"miles\";\n    }\n    // Avoid showing \".00\"\n    value = value.replace(/\\.00$/, \"\");\n    return `${value} ${unitLabel}`;\n  }\n\n  /**\n   * Dynamically loads the Google Maps JavaScript API using the importLibrary method.\n   * This is the standard approach recommended by Google.\n   * @see https://developers.google.com/maps/documentation/javascript/load-maps-js-api\n   * @param {object} g - Configuration object for the API loader (key, v, libraries, etc.).\n   */\n  async _loadGoogleMapsApi(g) {\n    var h, // Promise tracking API load\n      a, // Script element\n      k, // Loop variable for config keys\n      p = \"The Google Maps JavaScript API\", // Error message prefix\n      c = \"google\", // Global namespace\n      l = \"importLibrary\", // Loader function name\n      q = \"__ib__\", // Internal callback name\n      m = document, // Document reference\n      b = window; // Window reference\n    b = b[c] || (b[c] = {}); // Ensure google namespace exists\n    var d = b.maps || (b.maps = {}), // Ensure google.maps namespace exists\n      r = new Set(), // Set to track requested libraries\n      e = new URLSearchParams(), // URL parameters for the API script\n      u = () =>\n        // Function to initiate API loading (if not already started)\n        h ||\n        // eslint-disable-next-line no-async-promise-executor\n        (h = new Promise(async (f, n) => {\n          // Create script element (done async to potentially wait for nonce)\n          // await (a = m.createElement('script')); // Original Google code had await here, might not be needed\n          a = m.createElement(\"script\"); // Create script tag\n          e.set(\"libraries\", [...r].join(\",\")); // Add accumulated libraries\n          // Add other parameters from the config object 'g'\n          for (k in g)\n            e.set(\n              k.replace(/[A-Z]/g, (t) => \"_\" + t[0].toLowerCase()), // Convert camelCase to snake_case\n              g[k]\n            );\n          e.set(\"callback\", c + \".maps.\" + q); // Set the internal callback function name\n          a.src = `https://maps.${c}apis.com/maps/api/js?` + e; // Construct the API URL\n          d[q] = f; // Assign the promise resolver to the callback name on google.maps\n          // Error handling for script loading failure\n          a.onerror = () => (h = n(Error(p + \" could not load.\"))); // Use onerror for load failures\n          // Nonce for Content Security Policy\n          a.nonce = m.querySelector(\"script[nonce]\")?.nonce || \"\";\n          m.head.append(a); // Append the script to the document head\n        }));\n    // Define or reuse the importLibrary function on google.maps\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    d[l]\n      ? console.warn(p + \" only loads once. Ignoring:\", g) // Warn if called again\n      : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n))); // The actual importLibrary implementation\n  }\n\n  // --- UI Creation ---\n  _createPACStructure() {\n    const section = document.createElement(\"section\");\n    this.#options.classes.section\n      .split(\" \")\n      .forEach((cl) => cl && section.classList.add(cl));\n\n    // Main container\n    this.#container = document.createElement(\"div\");\n    this.#container.className = this.#options.classes.container;\n    this.#container.setAttribute(\"id\", this.#pacEl);\n    section.appendChild(this.#container);\n\n    // Icon\n    const iconContainer = document.createElement(\"div\");\n    iconContainer.className = this.#options.classes.icon_container;\n    this.#container.appendChild(iconContainer);\n    const icon = document.createElement(\"div\");\n    icon.innerHTML = this.#options.classes.icon;\n    iconContainer.appendChild(icon.firstElementChild); // Append the actual SVG element\n\n    // Input field\n    this.#inputElement = document.createElement(\"input\");\n    this.#inputElement.id = \"input\" + this.#pacEl; // Assign ID for label association\n    this.#inputElement.type = \"text\";\n    this.#inputElement.name = \"search\"; // Consider making name configurable\n    this.#inputElement.placeholder = this.#options.placeholder;\n    this.#inputElement.autocomplete = this.#options.autocomplete;\n    this.#inputElement.className = this.#options.classes.input;\n    this.#inputElement.setAttribute(\"role\", \"combobox\");\n    this.#inputElement.setAttribute(\"aria-autocomplete\", \"list\");\n    this.#inputElement.setAttribute(\"aria-expanded\", \"false\"); // Will be updated dynamically\n    this.#inputElement.setAttribute(\"aria-controls\", \"pacSuggestions\"); // Links to the suggestions list\n\n    if (this.#options.autofocus) {\n      this.#inputElement.autofocus = true;\n    }\n    if (this.#options.label) {\n      const label = document.createElement(\"label\");\n      label.htmlFor = \"labelInput\" + this.#pacEl; // Assuming inputElement gets this ID\n      label.textContent = this.#options.label;\n      // Add label classes if needed from opts.classes\n      this.#container.appendChild(label); // Append label before input or adjust structure\n    }\n    this.#container.appendChild(this.#inputElement);\n\n    // Keyboard hints container\n    const kbdContainer = document.createElement(\"div\");\n    kbdContainer.className = this.#options.classes.kbd_container;\n    this.#kbdEscape = document.createElement(\"kbd\");\n    this.#kbdEscape.className = this.#options.classes.kbd_escape;\n    this.#kbdEscape.textContent = \"Esc\";\n    kbdContainer.appendChild(this.#kbdEscape);\n    this.#kbdUp = document.createElement(\"kbd\");\n    this.#kbdUp.className = this.#options.classes.kbd_up;\n    this.#kbdUp.innerHTML = \"&#8593;\"; // Up arrow HTML entity\n    kbdContainer.appendChild(this.#kbdUp);\n    this.#kbdDown = document.createElement(\"kbd\");\n    this.#kbdDown.className = this.#options.classes.kbd_down;\n    this.#kbdDown.innerHTML = \"&#8595;\"; // Down arrow HTML entity\n    kbdContainer.appendChild(this.#kbdDown);\n    this.#container.appendChild(kbdContainer);\n\n    // Suggestions list (initially hidden)\n    this.#ul = document.createElement(\"ul\");\n    this.#ul.id = \"pacSuggestions\"; // Must match aria-controls\n    this.#ul.className = this.#options.classes.ul;\n    this.#ul.style.display = \"none\";\n    this.#ul.setAttribute(\"role\", \"listbox\");\n    this.#container.appendChild(this.#ul);\n\n    this.#pacEl.appendChild(section);\n    section.addEventListener(\"keydown\", this._onKeyDown.bind(this)); // Bind 'this'\n  }\n\n  /**\n   * Initializes the core autocomplete functionality after the API is loaded.\n   * Imports necessary libraries and sets up the input event listener.\n   */\n  async _initializeAutocomplete() {\n    try {\n      // Ensure the 'places' library is available via the dynamic loader\n      // eslint-disable-next-line no-undef\n      await google.maps.importLibrary(\"places\");\n      // console.log('Places library imported successfully.'); // For debugging\n\n      // Initial token generation\n      this._refreshToken();\n\n      // Attach the debounced request function to the input element's 'input' event\n      if (this.#inputElement) {\n        this.#inputElement.addEventListener(\n          \"input\",\n          this._debouncedMakeAcRequest.bind(this)\n        );\n        // Add focus/blur listeners if needed to manage suggestion visibility\n        this.#inputElement.addEventListener(\"blur\", () => {\n          // Delay hiding suggestions to allow click events on them\n          setTimeout(() => {\n            if (this.#ul && !this.#ul.contains(document.activeElement)) {\n              // Check if focus moved outside suggestions\n              this.#ul.style.display = \"none\";\n              this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n            }\n          }, 200); // Adjust delay as needed\n        });\n        this.#inputElement.addEventListener(\"focus\", () => {\n          // Potentially show suggestions again if input has value\n          if (this.#inputElement.value && this.#allSuggestions.length > 0) {\n            this.#ul.style.display = \"block\";\n            this.#inputElement.setAttribute(\"aria-expanded\", \"true\");\n          }\n        });\n      } else {\n        this.#onErrorCallback(\n          new Error(\"Input element not found during initialization.\")\n        );\n      }\n    } catch (error) {\n      console.error(\"Error initializing Google Places Autocomplete:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(\n        new Error(\"Google Maps Places library not available.\")\n      );\n    }\n  }\n\n  /**\n   * Resets the autocomplete input field, clears suggestions, and optionally refreshes the session token.\n   * @param {boolean} [refresh=false] - Whether to refresh the Google Places session token.\n   */\n  _reset(refresh = false) {\n    this.#currentSuggestion = -1;\n    if (this.#inputElement) {\n      this.#inputElement.value = \"\";\n    }\n    this.#allSuggestions = [];\n    this.#currentSuggestion = -1;\n    if (this.#ul) {\n      this.#ul.innerHTML = \"\"; // Clear existing suggestions\n      this.#ul.style.display = \"none\";\n    }\n    if (refresh) {\n      this._refreshToken();\n    }\n  }\n  /**\n   * Removes the 'current' highlighting classes from all suggestion list items (li) and their links (a).\n   */\n  _resetLiClasses() {\n    if (!this.#ul) return;\n    Array.from(this.#ul.children).forEach((li) => {\n      this.#options.classes.li_current\n        .split(\" \")\n        .forEach((cl) => li.classList.remove(cl));\n      const link = li.querySelector(\"a\");\n      if (link) {\n        this.#options.classes.li_a_current\n          .split(\" \")\n          .forEach((cl) => link.classList.remove(cl));\n      }\n    });\n  }\n\n  /**\n   * Handles keyboard events (ArrowDown, ArrowUp, Enter, Escape) for navigating\n   * and selecting suggestions or closing the list.\n   * @param {KeyboardEvent} e - The keyboard event object.\n   */\n  _onKeyDown(e) {\n    if (\n      !this.#allSuggestions.length ||\n      !this.#ul ||\n      this.#ul.style.display === \"none\"\n    )\n      return;\n\n    this._resetLiClasses(); // Reset classes on any key press within the suggestions\n\n    if (e.key === \"ArrowDown\") {\n      e.preventDefault(); // Prevent cursor movement in input\n      this.#currentSuggestion = Math.min(\n        this.#currentSuggestion + 1,\n        this.#allSuggestions.length - 1\n      );\n      if (this.#currentSuggestion < 0) this.#currentSuggestion = 0; // Handle case where it was -1\n\n      const currentLi = this.#ul.children.item(this.#currentSuggestion);\n      if (currentLi) {\n        const currentA = currentLi.querySelector(\"a\");\n        this.#options.classes.li_current\n          .split(\" \")\n          .forEach((cl) => currentLi.classList.add(cl));\n        if (currentA) {\n          this.#options.classes.li_a_current\n            .split(\" \")\n            .forEach((cl) => currentA.classList.add(cl));\n        }\n        currentLi.scrollIntoView({ block: \"nearest\" }); // Ensure visible\n      }\n\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdDown?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdDown?.classList.remove(cl)),\n        300\n      );\n    } else if (e.key === \"ArrowUp\") {\n      e.preventDefault(); // Prevent cursor movement in input\n      this.#currentSuggestion = Math.max(this.#currentSuggestion - 1, 0); // Stay at 0 if already there\n\n      const currentLi = this.#ul.children.item(this.#currentSuggestion);\n      if (currentLi) {\n        const currentA = currentLi.querySelector(\"a\");\n        this.#options.classes.li_current\n          .split(\" \")\n          .forEach((cl) => currentLi.classList.add(cl));\n        if (currentA) {\n          this.#options.classes.li_a_current\n            .split(\" \")\n            .forEach((cl) => currentA.classList.add(cl));\n        }\n        currentLi.scrollIntoView({ block: \"nearest\" }); // Ensure visible\n      }\n\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdUp?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdUp?.classList.remove(cl)),\n        300\n      );\n    } else if (e.key === \"Enter\") {\n      e.preventDefault(); // Prevent form submission if applicable\n      if (\n        this.#currentSuggestion >= 0 &&\n        this.#currentSuggestion < this.#allSuggestions.length\n      ) {\n        this._onPlaceSelected(\n          this.#allSuggestions[this.#currentSuggestion].place\n        );\n        // Reset is handled within onPlaceSelected via reset(true)\n      }\n    } else if (e.key === \"Escape\") {\n      e.preventDefault();\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdEscape?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdEscape?.classList.remove(cl)),\n        300\n      );\n      this._reset(true); // Reset search input and results, refresh token\n    }\n  }\n\n  /**\n   * Debounced function to fetch autocomplete suggestions from the Google Places API.\n   * Triggered by the 'input' event on the input element.\n   */\n  _debouncedMakeAcRequest = this._debounce(async () => {\n    if (!this.#inputElement || !this.#inputElement.value) {\n      this._reset();\n      if (this.#inputElement)\n        this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n      return;\n    }\n\n    this.#request.input = this.#inputElement.value;\n    //console.log(\"Request:\", this.#request); // Debugging\n    try {\n      const { suggestions } =\n        // eslint-disable-next-line no-undef\n        await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(\n          this.#request\n        );\n\n      // Display suggestions\n      if (suggestions && suggestions.length > 0) {\n        this.#ul.replaceChildren(\n          ...this._createSuggestionElements(suggestions)\n        );\n        this.#ul.style.display = \"block\";\n        this.#inputElement.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        // No suggestions found\n        this._reset(); // Clear any old suggestions\n        this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n        // Optionally display a \"no results\" message in the 'ul'\n      }\n    } catch (error) {\n      this.#onErrorCallback(error);\n      this._reset();\n      if (this.#inputElement)\n        this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n    }\n  }, this.#options?.debounce ?? 100);\n\n  /**\n   * Creates an array of list item (LI) elements for the suggestions dropdown.\n   * Each LI contains a link (A) with the place prediction details and distance.\n   * Handles highlighting the matched parts of the suggestion text.\n   * @param {Array<google.maps.places.AutocompleteSuggestion>} suggestions - Array of suggestion objects from the API.\n   * @returns {Array<HTMLLIElement>} An array of LI elements to be added to the suggestions UL.\n   */\n  _createSuggestionElements(suggestions) {\n    this.#allSuggestions = []; // Reset before populating\n    return suggestions.map((suggestion, index) => {\n      this.#allSuggestions.push({\n        id: index + 1,\n        description: suggestion.placePrediction.toString(),\n        place: suggestion.placePrediction.toPlace(),\n      });\n\n      // create div elements\n      const divContainer = document.createElement(\"div\");\n      divContainer.className = this.#options.classes.li_div_container; // flex min-w-0 gap-x-4\n      // create inner div element - place name\n      const divInner = document.createElement(\"div\");\n      divInner.className = this.#options.classes.li_div_one; // min-w-0 flex-auto\n      divContainer.appendChild(divInner);\n      // create p element - place name\n      const p = document.createElement(\"p\");\n      p.className = this.#options.classes.li_div_one_p; // text-sm/6\n\n      // get prediction text\n      const predictionText = suggestion.placePrediction.text;\n      const originalText = predictionText.text;\n      // Array of objects with startOffset, endOffset\n      const matches = predictionText.matches;\n\n      //Highlighting Logic\n      let lastIndex = 0;\n\n      // Sort matches just in case they aren't ordered (though they usually are)\n      matches.sort((a, b) => a.startOffset - b.startOffset);\n\n      // 1. Create the outer span\n      const outerSpan = document.createElement(\"span\");\n\n      // 2. Create the inner span for the bold part\n      const innerSpan = document.createElement(\"span\");\n      innerSpan.classList = this.#options.classes.highlight ?? \"font-bold\"; // Use the highlight class from options\n\n      for (const match of matches) {\n        // Append text before the current match\n        outerSpan.textContent += originalText.substring(\n          lastIndex,\n          match.startOffset\n        );\n\n        // Append the highlighted match segment\n        if (match.startOffset > 0) {\n          // check previous charter is space\n          const prevChar = originalText.charAt(match.startOffset - 1);\n          if (prevChar == \" \") {\n            innerSpan.textContent += \" \";\n          }\n        }\n        innerSpan.textContent += originalText.substring(\n          match.startOffset,\n          match.endOffset\n        );\n\n        // Update the last index processed\n        lastIndex = match.endOffset;\n      }\n\n      // 3. Create a text node for the remaining text\n      const remainingText = document.createTextNode(\n        originalText.substring(lastIndex)\n      );\n\n      // 4. Append the inner span and the text node to the outer span\n      outerSpan.appendChild(innerSpan);\n      outerSpan.appendChild(remainingText);\n\n      // 5. Append the outer span to the paragraph element\n      p.appendChild(outerSpan);\n\n      divInner.appendChild(p);\n      divContainer.appendChild(divInner);\n\n      // create inner div element - distance\n      const divInner2 = document.createElement(\"div\");\n      divInner2.className = this.#options.classes.li_div_two; //'shrink-0 flex flex-col items-end min-w-16';\n      divContainer.appendChild(divInner2);\n      // create p element - distance\n      const p2 = document.createElement(\"p\");\n      p2.className = this.#options.classes.li_div_two_p; //'mt-1 text-xs/5 ';\n      p2.textContent = this._formatDistance(\n        suggestion.placePrediction.distanceMeters,\n        this.#options.distance_units ?? \"km\"\n      );\n      divInner2.appendChild(p2);\n\n      // // create a link element\n      const a = document.createElement(\"a\");\n      a.href = \"javascript:void(0)\";\n      a.tabIndex = index + 1;\n      a.className = this.#options.classes.li_a; // block w-full flex justify-between\n\n      a.addEventListener(\"click\", () => {\n        this._onPlaceSelected(suggestion.placePrediction.toPlace());\n      });\n\n      // ...\n      // a.addEventListener(\"click\", () => {\n      //   this._fetchPlaceDetails(prediction.place_id);\n      // });\n      a.appendChild(divContainer);\n      a.appendChild(divInner2);\n\n      const li = document.createElement(\"li\");\n      li.id = `option-${index + 1}`;\n      li.className = this.#options.classes.li;\n\n      li.appendChild(a);\n      return li;\n    });\n  }\n\n  /**\n   * Handles the selection of a place. Fetches required fields\n   * (displayName, formattedAddress, addressComponents) and calls the\n   * user-defined `onPacData` callback.\n   * @param {google.maps.places.Place} place - The selected Place object.\n   */\n  async _onPlaceSelected(place) {\n    try {\n      // Fetch necessary details for the selected place\n      await place.fetchFields({\n        fields: [\"displayName\", \"formattedAddress\", \"addressComponents\"], // Add more fields as needed\n      });\n      // Call the user-provided callback with the place data\n      // eslint-disable-next-line no-undef\n      this.#onDataCallback(place.toJSON()); // Convert to plain JSON object for the callback\n    } catch (error) {\n      console.error(\"Error fetching place details:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(error);\n    } finally {\n      // Reset the input and suggestions regardless of success/error\n      this._reset(true); // Refresh token after selection\n    }\n  }\n\n  /**\n   * Creates a new Google Places Autocomplete Session Token.\n   * This should be called before starting a new series of autocomplete requests.\n   */\n  _refreshToken() {\n    try {\n      // eslint-disable-next-line no-undef\n      this.#request.sessionToken =\n        new google.maps.places.AutocompleteSessionToken();\n    } catch (error) {\n      console.error(\"Error creating session token:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(error);\n    }\n  }\n\n  clear() {\n    this._reset(true);\n  }\n\n  destroy() {\n    // Remove event listeners, remove elements from DOM\n    if (this.#inputElement) {\n      this.#inputElement.removeEventListener(\n        \"input\",\n        this._debouncedMakeAcRequest\n      );\n      // remove other listeners\n    }\n    if (this.#pacEl && this.#container) {\n      this.#pacEl.removeChild(this.#container.parentElement); // remove the whole section\n    }\n    // Nullify properties\n    for (const prop in this) {\n      if (Object.hasOwn(this, prop)) {\n        this[prop] = null;\n      }\n    }\n    console.log(\"PacAutocomplete instance destroyed.\");\n  }\n}\n"],"names":["PlacesAutocompleteJs","config","__privateAdd","_pacEl","_googleMapsApiKey","_googleMapsApiVersion","_options","_request","_inputElement","_container","_ul","_kbdEscape","_kbdUp","_kbdDown","_allSuggestions","_currentSuggestion","_onDataCallback","_onErrorCallback","_defaultClasses","__publicField","__privateGet","suggestions","error","_a","__privateSet","place","func","wait","timeout","args","later","distance","units","value","unitLabel","g","h","a","k","p","c","l","q","m","b","d","r","e","u","f","n","t","section","cl","iconContainer","icon","label","kbdContainer","refresh","li","link","currentLi","currentA","suggestion","index","divContainer","divInner","predictionText","originalText","matches","lastIndex","outerSpan","innerSpan","match","remainingText","divInner2","p2","prop"],"mappings":"utBAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,yCAgBO,MAAMA,CAAqB,CA0DhC,YAAYC,EAAQ,CAxDpBC,EAAA,KAAAC,GACAD,EAAA,KAAAE,GACAF,EAAA,KAAAG,GACAH,EAAA,KAAAI,GACAJ,EAAA,KAAAK,GACAL,EAAA,KAAAM,GACAN,EAAA,KAAAO,GACAP,EAAA,KAAAQ,GACAR,EAAA,KAAAS,GACAT,EAAA,KAAAU,GACAV,EAAA,KAAAW,GACAX,EAAA,KAAAY,EAAkB,CAAE,GACpBZ,EAAA,KAAAa,EAAqB,IACrBb,EAAA,KAAAc,GACAd,EAAA,KAAAe,GACAf,EAAA,KAAAgB,EAAkB,CAEhB,QAAS,GACT,UAAW,0CACX,eACE,uEACF,KAAM,kPACN,MACE,0JACF,cAAe,gDACf,WACE,wGACF,OACE,kHACF,SACE,kHACF,WAAY,2BACZ,GAAI,8LACJ,GAAI,uGACJ,WAAY,gBACZ,KAAM,oCACN,aAAc,aACd,iBAAkB,uBAClB,WAAY,oBACZ,aAAc,YACd,WAAY,4CACZ,aAAc,iBACd,UAAW,WACZ,GAkdDC,EAAA,+BAA0B,KAAK,UAAU,SAAY,CACnD,GAAI,CAACC,EAAA,KAAKZ,IAAiB,CAACY,EAAA,KAAKZ,GAAc,MAAO,CACpD,KAAK,OAAQ,EACTY,EAAA,KAAKZ,IACPY,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,OAAO,EAC1D,MACN,CAEIY,EAAA,KAAKb,GAAS,MAAQa,EAAA,KAAKZ,GAAc,MAEzC,GAAI,CACF,KAAM,CAAE,YAAAa,CAAa,EAEnB,MAAM,OAAO,KAAK,OAAO,uBAAuB,6BAC9CD,EAAA,KAAKb,EACN,EAGCc,GAAeA,EAAY,OAAS,GACtCD,EAAA,KAAKV,GAAI,gBACP,GAAG,KAAK,0BAA0BW,CAAW,CAC9C,EACDD,EAAA,KAAKV,GAAI,MAAM,QAAU,QACzBU,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,MAAM,IAGvD,KAAK,OAAM,EACXY,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,OAAO,EAG3D,OAAQc,EAAO,CACdF,EAAA,KAAKH,GAAL,UAAsBK,GACtB,KAAK,OAAQ,EACTF,EAAA,KAAKZ,IACPY,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,OAAO,CAChE,CACG,IAAEe,EAAAH,EAAA,KAAKd,KAAL,YAAAiB,EAAe,WAAY,GAAG,GAve/B,GAAI,CAACtB,GAAU,CAACA,EAAO,aAAe,CAACA,EAAO,iBAC5C,MAAM,IAAI,MACR,kFACD,EAIH,GADAuB,EAAA,KAAKrB,EAAS,SAAS,eAAeF,EAAO,WAAW,GACpD,CAACmB,EAAA,KAAKjB,GACR,MAAM,IAAI,MACR,+CAA+CF,EAAO,WAAW,cAClE,EAGHuB,EAAA,KAAKpB,EAAoBH,EAAO,kBAChCuB,EAAA,KAAKnB,EAAwBJ,EAAO,sBAAwB,UAG5DuB,EAAA,KAAKlB,EAAW,CACd,UAAW,GACX,aAAc,MACd,YAAa,gCACb,SAAU,GACV,eAAgB,KAChB,MAAO,GACP,SAAU,IACV,GAAGL,EAAO,OACX,GAEGA,EAAO,SAAWA,EAAO,QAAQ,UACnCmB,EAAA,KAAKd,GAAS,QAAU,CACtB,GAAGc,EAAA,KAAKF,GACR,GAAGjB,EAAO,QAAQ,OACnB,GAIHuB,EAAA,KAAKR,EACHf,EAAO,aACLwB,GAAU,CACV,QAAQ,KAAK,mDAAmD,EAChE,QAAQ,KAAK,kBAAmB,KAAK,UAAUA,EAAO,KAAM,CAAC,CAAC,CACtE,IACID,EAAA,KAAKP,EACHhB,EAAO,UACLqB,GAAU,CACV,QAAQ,MAAM,gDAAgD,EAC9D,QAAQ,MAAM,aAAcA,CAAK,CACzC,IAEIE,EAAA,KAAKjB,EAAW,CACd,MAAO,GACP,oBAAqB,CAAC,IAAI,EAC1B,SAAU,QACV,OAAQ,KACR,GAAGN,EAAO,aACX,GAID,KAAK,MAAK,CACd,CAGE,MAAM,OAAQ,CACZ,GAAI,EAEE,OAAO,OAAW,KAAe,CAAC,OAAO,OAE3C,MAAM,KAAK,mBAAmB,CAC5B,IAAKmB,EAAA,KAAKhB,GACV,EAAGgB,EAAA,KAAKf,EAClB,CAAS,EAEH,KAAK,oBAAmB,EACxB,MAAM,KAAK,yBAEZ,OAAQiB,EAAO,CACdF,EAAA,KAAKH,GAAL,UAAsBK,EAC5B,CACA,CAUE,UAAUI,EAAMC,EAAM,CACpB,IAAIC,EAAU,KACd,OAAO,YAA6BC,EAAM,CACxC,MAAMC,EAAQ,IAAM,CAClBF,EAAU,KACVF,EAAK,GAAGG,CAAI,CACb,EACGD,IAAY,MACd,aAAaA,CAAO,EAEtBA,EAAU,WAAWE,EAAOH,GAAQ,GAAG,CACxC,CACL,CAOE,gBAAgBI,EAAUC,EAAO,CAC/B,GAAI,OAAOD,GAAa,UAAY,CAACX,EAAA,KAAKd,GAAS,SACjD,OAAO,KAET,IAAI2B,EACAC,EACJ,OAAIF,IAAU,MACZC,GAASF,EAAW,KAAM,QAAQ,CAAC,EACnCG,EAAY,OAGZD,GAASF,EAAW,SAAS,QAAQ,CAAC,EACtCG,EAAY,SAGdD,EAAQA,EAAM,QAAQ,QAAS,EAAE,EAC1B,GAAGA,CAAK,IAAIC,CAAS,EAChC,CAQE,MAAM,mBAAmBC,EAAG,CAC1B,IAAIC,EACFC,EACAC,EACAC,EAAI,iCACJC,EAAI,SACJC,EAAI,gBACJC,EAAI,SACJC,EAAI,SACJC,EAAI,OACNA,EAAIA,EAAEJ,CAAC,IAAMI,EAAEJ,CAAC,EAAI,CAAA,GACpB,IAAIK,EAAID,EAAE,OAASA,EAAE,KAAO,CAAA,GAC1BE,EAAI,IAAI,IACRC,EAAI,IAAI,gBACRC,EAAI,IAEFZ,IAECA,EAAI,IAAI,QAAQ,MAAOa,EAAGC,IAAM,OAG/Bb,EAAIM,EAAE,cAAc,QAAQ,EAC5BI,EAAE,IAAI,YAAa,CAAC,GAAGD,CAAC,EAAE,KAAK,GAAG,CAAC,EAEnC,IAAKR,KAAKH,EACRY,EAAE,IACAT,EAAE,QAAQ,SAAWa,GAAM,IAAMA,EAAE,CAAC,EAAE,aAAa,EACnDhB,EAAEG,CAAC,CACJ,EACHS,EAAE,IAAI,WAAYP,EAAI,SAAWE,CAAC,EAClCL,EAAE,IAAM,gBAAgBG,CAAC,wBAA0BO,EACnDF,EAAEH,CAAC,EAAIO,EAEPZ,EAAE,QAAU,IAAOD,EAAIc,EAAE,MAAMX,EAAI,kBAAkB,CAAC,EAEtDF,EAAE,QAAQd,EAAAoB,EAAE,cAAc,eAAe,IAA/B,YAAApB,EAAkC,QAAS,GACrDoB,EAAE,KAAK,OAAON,CAAC,CACzB,CAAS,GAGLQ,EAAEJ,CAAC,EACC,QAAQ,KAAKF,EAAI,8BAA+BJ,CAAC,EAChDU,EAAEJ,CAAC,EAAI,CAACQ,KAAMC,IAAMJ,EAAE,IAAIG,CAAC,GAAKD,EAAC,EAAG,KAAK,IAAMH,EAAEJ,CAAC,EAAEQ,EAAG,GAAGC,CAAC,CAAC,CACrE,CAGE,qBAAsB,CACpB,MAAME,EAAU,SAAS,cAAc,SAAS,EAChDhC,EAAA,KAAKd,GAAS,QAAQ,QACnB,MAAM,GAAG,EACT,QAAS+C,GAAOA,GAAMD,EAAQ,UAAU,IAAIC,CAAE,CAAC,EAGlD7B,EAAA,KAAKf,EAAa,SAAS,cAAc,KAAK,GAC9CW,EAAA,KAAKX,GAAW,UAAYW,EAAA,KAAKd,GAAS,QAAQ,UAClDc,EAAA,KAAKX,GAAW,aAAa,KAAMW,EAAA,KAAKjB,EAAM,EAC9CiD,EAAQ,YAAYhC,EAAA,KAAKX,EAAU,EAGnC,MAAM6C,EAAgB,SAAS,cAAc,KAAK,EAClDA,EAAc,UAAYlC,EAAA,KAAKd,GAAS,QAAQ,eAChDc,EAAA,KAAKX,GAAW,YAAY6C,CAAa,EACzC,MAAMC,EAAO,SAAS,cAAc,KAAK,EAoBzC,GAnBAA,EAAK,UAAYnC,EAAA,KAAKd,GAAS,QAAQ,KACvCgD,EAAc,YAAYC,EAAK,iBAAiB,EAGhD/B,EAAA,KAAKhB,EAAgB,SAAS,cAAc,OAAO,GACnDY,EAAA,KAAKZ,GAAc,GAAK,QAAUY,EAAA,KAAKjB,GACvCiB,EAAA,KAAKZ,GAAc,KAAO,OAC1BY,EAAA,KAAKZ,GAAc,KAAO,SAC1BY,EAAA,KAAKZ,GAAc,YAAcY,EAAA,KAAKd,GAAS,YAC/Cc,EAAA,KAAKZ,GAAc,aAAeY,EAAA,KAAKd,GAAS,aAChDc,EAAA,KAAKZ,GAAc,UAAYY,EAAA,KAAKd,GAAS,QAAQ,MACrDc,EAAA,KAAKZ,GAAc,aAAa,OAAQ,UAAU,EAClDY,EAAA,KAAKZ,GAAc,aAAa,oBAAqB,MAAM,EAC3DY,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,OAAO,EACxDY,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,gBAAgB,EAE7DY,EAAA,KAAKd,GAAS,YAChBc,EAAA,KAAKZ,GAAc,UAAY,IAE7BY,EAAA,KAAKd,GAAS,MAAO,CACvB,MAAMkD,EAAQ,SAAS,cAAc,OAAO,EAC5CA,EAAM,QAAU,aAAepC,EAAA,KAAKjB,GACpCqD,EAAM,YAAcpC,EAAA,KAAKd,GAAS,MAElCc,EAAA,KAAKX,GAAW,YAAY+C,CAAK,CACvC,CACIpC,EAAA,KAAKX,GAAW,YAAYW,EAAA,KAAKZ,EAAa,EAG9C,MAAMiD,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAYrC,EAAA,KAAKd,GAAS,QAAQ,cAC/CkB,EAAA,KAAKb,EAAa,SAAS,cAAc,KAAK,GAC9CS,EAAA,KAAKT,GAAW,UAAYS,EAAA,KAAKd,GAAS,QAAQ,WAClDc,EAAA,KAAKT,GAAW,YAAc,MAC9B8C,EAAa,YAAYrC,EAAA,KAAKT,EAAU,EACxCa,EAAA,KAAKZ,EAAS,SAAS,cAAc,KAAK,GAC1CQ,EAAA,KAAKR,GAAO,UAAYQ,EAAA,KAAKd,GAAS,QAAQ,OAC9Cc,EAAA,KAAKR,GAAO,UAAY,UACxB6C,EAAa,YAAYrC,EAAA,KAAKR,EAAM,EACpCY,EAAA,KAAKX,EAAW,SAAS,cAAc,KAAK,GAC5CO,EAAA,KAAKP,GAAS,UAAYO,EAAA,KAAKd,GAAS,QAAQ,SAChDc,EAAA,KAAKP,GAAS,UAAY,UAC1B4C,EAAa,YAAYrC,EAAA,KAAKP,EAAQ,EACtCO,EAAA,KAAKX,GAAW,YAAYgD,CAAY,EAGxCjC,EAAA,KAAKd,EAAM,SAAS,cAAc,IAAI,GACtCU,EAAA,KAAKV,GAAI,GAAK,iBACdU,EAAA,KAAKV,GAAI,UAAYU,EAAA,KAAKd,GAAS,QAAQ,GAC3Cc,EAAA,KAAKV,GAAI,MAAM,QAAU,OACzBU,EAAA,KAAKV,GAAI,aAAa,OAAQ,SAAS,EACvCU,EAAA,KAAKX,GAAW,YAAYW,EAAA,KAAKV,EAAG,EAEpCU,EAAA,KAAKjB,GAAO,YAAYiD,CAAO,EAC/BA,EAAQ,iBAAiB,UAAW,KAAK,WAAW,KAAK,IAAI,CAAC,CAClE,CAME,MAAM,yBAA0B,CAC9B,GAAI,CAGF,MAAM,OAAO,KAAK,cAAc,QAAQ,EAIxC,KAAK,cAAe,EAGhBhC,EAAA,KAAKZ,IACPY,EAAA,KAAKZ,GAAc,iBACjB,QACA,KAAK,wBAAwB,KAAK,IAAI,CACvC,EAEDY,EAAA,KAAKZ,GAAc,iBAAiB,OAAQ,IAAM,CAEhD,WAAW,IAAM,CACXY,EAAA,KAAKV,IAAO,CAACU,EAAA,KAAKV,GAAI,SAAS,SAAS,aAAa,IAEvDU,EAAA,KAAKV,GAAI,MAAM,QAAU,OACzBU,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,OAAO,EAE3D,EAAE,GAAG,CAChB,CAAS,EACDY,EAAA,KAAKZ,GAAc,iBAAiB,QAAS,IAAM,CAE7CY,EAAA,KAAKZ,GAAc,OAASY,EAAA,KAAKN,GAAgB,OAAS,IAC5DM,EAAA,KAAKV,GAAI,MAAM,QAAU,QACzBU,EAAA,KAAKZ,GAAc,aAAa,gBAAiB,MAAM,EAEnE,CAAS,GAEDY,EAAA,KAAKH,GAAL,UACE,IAAI,MAAM,gDAAgD,EAG/D,OAAQK,EAAO,CACd,QAAQ,MAAM,iDAAkDA,CAAK,EAErEF,EAAA,KAAKH,GAAL,UACE,IAAI,MAAM,2CAA2C,EAE7D,CACA,CAME,OAAOyC,EAAU,GAAO,CACtBlC,EAAA,KAAKT,EAAqB,IACtBK,EAAA,KAAKZ,KACPY,EAAA,KAAKZ,GAAc,MAAQ,IAE7BgB,EAAA,KAAKV,EAAkB,CAAE,GACzBU,EAAA,KAAKT,EAAqB,IACtBK,EAAA,KAAKV,KACPU,EAAA,KAAKV,GAAI,UAAY,GACrBU,EAAA,KAAKV,GAAI,MAAM,QAAU,QAEvBgD,GACF,KAAK,cAAe,CAE1B,CAIE,iBAAkB,CACXtC,EAAA,KAAKV,IACV,MAAM,KAAKU,EAAA,KAAKV,GAAI,QAAQ,EAAE,QAASiD,GAAO,CAC5CvC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,GAAOM,EAAG,UAAU,OAAON,CAAE,CAAC,EAC1C,MAAMO,EAAOD,EAAG,cAAc,GAAG,EAC7BC,GACFxC,EAAA,KAAKd,GAAS,QAAQ,aACnB,MAAM,GAAG,EACT,QAAS+C,GAAOO,EAAK,UAAU,OAAOP,CAAE,CAAC,CAEpD,CAAK,CACL,CAOE,WAAWN,EAAG,CACZ,GACE,GAAC3B,EAAA,KAAKN,GAAgB,QACtB,CAACM,EAAA,KAAKV,IACNU,EAAA,KAAKV,GAAI,MAAM,UAAY,QAM7B,GAFA,KAAK,gBAAe,EAEhBqC,EAAE,MAAQ,YAAa,CACzBA,EAAE,eAAc,EAChBvB,EAAA,KAAKT,EAAqB,KAAK,IAC7BK,EAAA,KAAKL,GAAqB,EAC1BK,EAAA,KAAKN,GAAgB,OAAS,CAC/B,GACGM,EAAA,KAAKL,GAAqB,GAAGS,EAAA,KAAKT,EAAqB,GAE3D,MAAM8C,EAAYzC,EAAA,KAAKV,GAAI,SAAS,KAAKU,EAAA,KAAKL,EAAkB,EAChE,GAAI8C,EAAW,CACb,MAAMC,EAAWD,EAAU,cAAc,GAAG,EAC5CzC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,GAAOQ,EAAU,UAAU,IAAIR,CAAE,CAAC,EAC1CS,GACF1C,EAAA,KAAKd,GAAS,QAAQ,aACnB,MAAM,GAAG,EACT,QAAS+C,GAAOS,EAAS,UAAU,IAAIT,CAAE,CAAC,EAE/CQ,EAAU,eAAe,CAAE,MAAO,SAAW,CAAA,CACrD,CAGMzC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKP,KAAL,YAAAU,EAAe,UAAU,IAAI8B,GAAG,EACnD,WACE,IACEjC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKP,KAAL,YAAAU,EAAe,UAAU,OAAO8B,GAAG,EACxD,GACD,CACP,SAAeN,EAAE,MAAQ,UAAW,CAC9BA,EAAE,eAAc,EAChBvB,EAAA,KAAKT,EAAqB,KAAK,IAAIK,EAAA,KAAKL,GAAqB,EAAG,CAAC,GAEjE,MAAM8C,EAAYzC,EAAA,KAAKV,GAAI,SAAS,KAAKU,EAAA,KAAKL,EAAkB,EAChE,GAAI8C,EAAW,CACb,MAAMC,EAAWD,EAAU,cAAc,GAAG,EAC5CzC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,GAAOQ,EAAU,UAAU,IAAIR,CAAE,CAAC,EAC1CS,GACF1C,EAAA,KAAKd,GAAS,QAAQ,aACnB,MAAM,GAAG,EACT,QAAS+C,GAAOS,EAAS,UAAU,IAAIT,CAAE,CAAC,EAE/CQ,EAAU,eAAe,CAAE,MAAO,SAAW,CAAA,CACrD,CAGMzC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKR,KAAL,YAAAW,EAAa,UAAU,IAAI8B,GAAG,EACjD,WACE,IACEjC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKR,KAAL,YAAAW,EAAa,UAAU,OAAO8B,GAAG,EACtD,GACD,CACP,MAAeN,EAAE,MAAQ,SACnBA,EAAE,eAAc,EAEd3B,EAAA,KAAKL,IAAsB,GAC3BK,EAAA,KAAKL,GAAqBK,EAAA,KAAKN,GAAgB,QAE/C,KAAK,iBACHM,EAAA,KAAKN,GAAgBM,EAAA,KAAKL,EAAkB,EAAE,KAC/C,GAGMgC,EAAE,MAAQ,WACnBA,EAAE,eAAgB,EAElB3B,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKT,KAAL,YAAAY,EAAiB,UAAU,IAAI8B,GAAG,EACrD,WACE,IACEjC,EAAA,KAAKd,GAAS,QAAQ,WACnB,MAAM,GAAG,EACT,QAAS+C,UAAO,OAAA9B,EAAAH,EAAA,KAAKT,KAAL,YAAAY,EAAiB,UAAU,OAAO8B,GAAG,EAC1D,GACD,EACD,KAAK,OAAO,EAAI,EAEtB,CAmDE,0BAA0BhC,EAAa,CACrC,OAAAG,EAAA,KAAKV,EAAkB,IAChBO,EAAY,IAAI,CAAC0C,EAAYC,IAAU,CAC5C5C,EAAA,KAAKN,GAAgB,KAAK,CACxB,GAAIkD,EAAQ,EACZ,YAAaD,EAAW,gBAAgB,SAAU,EAClD,MAAOA,EAAW,gBAAgB,QAAS,CACnD,CAAO,EAGD,MAAME,EAAe,SAAS,cAAc,KAAK,EACjDA,EAAa,UAAY7C,EAAA,KAAKd,GAAS,QAAQ,iBAE/C,MAAM4D,EAAW,SAAS,cAAc,KAAK,EAC7CA,EAAS,UAAY9C,EAAA,KAAKd,GAAS,QAAQ,WAC3C2D,EAAa,YAAYC,CAAQ,EAEjC,MAAM3B,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,UAAYnB,EAAA,KAAKd,GAAS,QAAQ,aAGpC,MAAM6D,EAAiBJ,EAAW,gBAAgB,KAC5CK,EAAeD,EAAe,KAE9BE,EAAUF,EAAe,QAG/B,IAAIG,EAAY,EAGhBD,EAAQ,KAAK,CAAChC,EAAGO,IAAMP,EAAE,YAAcO,EAAE,WAAW,EAGpD,MAAM2B,EAAY,SAAS,cAAc,MAAM,EAGzCC,EAAY,SAAS,cAAc,MAAM,EAC/CA,EAAU,UAAYpD,EAAA,KAAKd,GAAS,QAAQ,WAAa,YAEzD,UAAWmE,KAASJ,EAElBE,EAAU,aAAeH,EAAa,UACpCE,EACAG,EAAM,WACP,EAGGA,EAAM,YAAc,GAELL,EAAa,OAAOK,EAAM,YAAc,CAAC,GAC1C,MACdD,EAAU,aAAe,KAG7BA,EAAU,aAAeJ,EAAa,UACpCK,EAAM,YACNA,EAAM,SACP,EAGDH,EAAYG,EAAM,UAIpB,MAAMC,EAAgB,SAAS,eAC7BN,EAAa,UAAUE,CAAS,CACjC,EAGDC,EAAU,YAAYC,CAAS,EAC/BD,EAAU,YAAYG,CAAa,EAGnCnC,EAAE,YAAYgC,CAAS,EAEvBL,EAAS,YAAY3B,CAAC,EACtB0B,EAAa,YAAYC,CAAQ,EAGjC,MAAMS,EAAY,SAAS,cAAc,KAAK,EAC9CA,EAAU,UAAYvD,EAAA,KAAKd,GAAS,QAAQ,WAC5C2D,EAAa,YAAYU,CAAS,EAElC,MAAMC,EAAK,SAAS,cAAc,GAAG,EACrCA,EAAG,UAAYxD,EAAA,KAAKd,GAAS,QAAQ,aACrCsE,EAAG,YAAc,KAAK,gBACpBb,EAAW,gBAAgB,eAC3B3C,EAAA,KAAKd,GAAS,gBAAkB,IACjC,EACDqE,EAAU,YAAYC,CAAE,EAGxB,MAAMvC,EAAI,SAAS,cAAc,GAAG,EACpCA,EAAE,KAAO,qBACTA,EAAE,SAAW2B,EAAQ,EACrB3B,EAAE,UAAYjB,EAAA,KAAKd,GAAS,QAAQ,KAEpC+B,EAAE,iBAAiB,QAAS,IAAM,CAChC,KAAK,iBAAiB0B,EAAW,gBAAgB,QAAO,CAAE,CAClE,CAAO,EAMD1B,EAAE,YAAY4B,CAAY,EAC1B5B,EAAE,YAAYsC,CAAS,EAEvB,MAAMhB,EAAK,SAAS,cAAc,IAAI,EACtC,OAAAA,EAAG,GAAK,UAAUK,EAAQ,CAAC,GAC3BL,EAAG,UAAYvC,EAAA,KAAKd,GAAS,QAAQ,GAErCqD,EAAG,YAAYtB,CAAC,EACTsB,CACb,CAAK,CACL,CAQE,MAAM,iBAAiBlC,EAAO,CAC5B,GAAI,CAEF,MAAMA,EAAM,YAAY,CACtB,OAAQ,CAAC,cAAe,mBAAoB,mBAAmB,CACvE,CAAO,EAGDL,EAAA,KAAKJ,GAAL,UAAqBS,EAAM,OAAQ,EACpC,OAAQH,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,EAEpDF,EAAA,KAAKH,GAAL,UAAsBK,EAC5B,QAAc,CAER,KAAK,OAAO,EAAI,CACtB,CACA,CAME,eAAgB,CACd,GAAI,CAEFF,EAAA,KAAKb,GAAS,aACZ,IAAI,OAAO,KAAK,OAAO,wBAC1B,OAAQe,EAAO,CACd,QAAQ,MAAM,gCAAiCA,CAAK,EAEpDF,EAAA,KAAKH,GAAL,UAAsBK,EAC5B,CACA,CAEE,OAAQ,CACN,KAAK,OAAO,EAAI,CACpB,CAEE,SAAU,CAEJF,EAAA,KAAKZ,IACPY,EAAA,KAAKZ,GAAc,oBACjB,QACA,KAAK,uBACN,EAGCY,EAAA,KAAKjB,IAAUiB,EAAA,KAAKX,IACtBW,EAAA,KAAKjB,GAAO,YAAYiB,EAAA,KAAKX,GAAW,aAAa,EAGvD,UAAWoE,KAAQ,KACb,OAAO,OAAO,KAAMA,CAAI,IAC1B,KAAKA,CAAI,EAAI,MAGjB,QAAQ,IAAI,qCAAqC,CACrD,CACA,CAhuBE1E,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA,YACAC,EAAA"}