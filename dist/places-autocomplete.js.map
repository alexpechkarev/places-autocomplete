{"version":3,"file":"places-autocomplete.js","sources":["../lib/PlacesAutocomplete.js"],"sourcesContent":["/**\n * Initializes a Places Autocomplete widget.\n * This script dynamically loads the Google Maps JavaScript API, creates the UI elements\n * for the autocomplete input and suggestions list, handles user input with debouncing,\n * fetches suggestions, manages keyboard navigation, and calls user-defined callbacks\n * on place selection or error.\n *\n * @author Alexander Pechkarev <alexpechkarev@gmail.com>\n * @license MIT\n *\n */\n\n/**\n * PacAutocomplete class\n * This class provides a Places Autocomplete widget.\n */\nexport class PlacesAutocomplete {\n  // --- Private Properties (using # or _ prefix by convention) ---\n  #containerId; // Container ID where the autocomplete widget will be rendered.\n  #pacEl;\n  #googleMapsApiKey;\n  #googleMapsApiVersion;\n  #options;\n  #request;\n  #inputElement;\n  #container;\n  #ul;\n  #kbdEscape;\n  #kbdUp;\n  #kbdDown;\n  #allSuggestions = [];\n  #currentSuggestion = -1;\n  #onDataCallback; // For user-provided data callback\n  #onErrorCallback; // For user-provided error callback\n  #defaultOptions = {\n    // Default options for the autocomplete widget.\n    autofocus: false, // Automatically focus the input on load.\n    autocomplete: \"off\", // HTML autocomplete attribute for the input.\n    placeholder: \"Start typing your address ...\", // Placeholder text for the input.\n    distance: true, // Show distance in suggestions (requires origin in request).\n    distance_units: \"km\", // Units for distance ('km' or 'miles').\n    label: \"\", // Optional label text above the input.\n    debounce: 100, // Debounce delay (ms) for API requests.\n    clear_input: true, // Clear input button (not implemented in this version).\n  };\n  #defaultClasses = {\n    // CSS classes for various parts of the widget.\n    section: \"\", // Outer section container.\n    container: \"relative z-10 transform rounded-xl mt-4\", // Main container div.\n    icon_container:\n      \"pointer-events-none absolute inset-y-0 left-0 flex items-center pl-3\", // Container for the search icon.\n    icon: '<svg xmlns=\"http://www.w3.org/2000/svg\" class=\"w-5 h-5\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\" stroke-linecap=\"round\" stroke-linejoin=\"round\"><circle cx=\"11\" cy=\"11\" r=\"8\" /><path d=\"m21 21-4.3-4.3\" /></svg>', // SVG for the search icon.\n    input:\n      \"border-1 w-full rounded-md border-0 shadow-sm bg-gray-100 px-4 py-2.5 pl-10 pr-20 text-gray-900 ring-1 ring-inset ring-gray-300 focus:ring-2 sm:text-sm\", // Input field.\n    kbd_container: \"absolute inset-y-0 right-0 flex py-1.5 pr-1.5\", // Container for keyboard hints.\n    kbd_escape:\n      \"inline-flex items-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-8 mr-1\", // Escape key hint.\n    kbd_up:\n      \"inline-flex items-center justify-center rounded border border-gray-300 px-1 font-sans text-xs text-gray-500 w-6\", // Up arrow key hint.\n    kbd_down:\n      \"inline-flex items-center rounded border border-gray-400 px-1 font-sans text-xs text-gray-500 justify-center w-6\", // Down arrow key hint.\n    kbd_active: \"bg-indigo-500 text-white\", // Class for active keyboard hint.\n    ul: \"absolute z-50 -mb-2 mt-1 max-h-60 w-full overflow-auto rounded-md bg-white py-1 text-base shadow-lg ring-1 ring-black ring-opacity-5 focus:outline-none sm:text-sm divide-y divide-gray-100\", // Suggestions list (ul).\n    li: \"z-50 cursor-default select-none py-2 px-2 lg:px-4 text-gray-900 hover:bg-indigo-500 hover:text-white\", // Suggestion item (li).\n    li_current: \"bg-indigo-500\", // Class for the currently selected suggestion item.\n    li_a: \"block w-full flex justify-between\", // Link element within a suggestion item.\n    li_a_current: \"text-white\", // Class for the link in the currently selected suggestion item.\n    li_div_container: \"flex min-w-0 gap-x-4\", // Container div within the suggestion link.\n    li_div_one: \"min-w-0 flex-auto\", // First inner div (for place name).\n    li_div_one_p: \"text-sm/6\", // Paragraph for the place name.\n    li_div_two: \"shrink-0 flex flex-col items-end min-w-16\", // Second inner div (for distance).\n    li_div_two_p: \"mt-1 text-xs/5\", // Paragraph for the distance.\n    highlight: \"font-bold\", // Class for highlighting matched text in suggestions.\n  };\n  #defaultRequestParams = {\n    // Default parameters for the autocomplete request.\n    input: \"\", // Initial input value (empty).\n    includedRegionCodes: [\"GB\"], // Default region codes to include in suggestions.\n    language: \"en-gb\",\n    region: \"GB\",\n  };\n  #fetchFields = [\"formattedAddress\", \"addressComponents\"];\n  #defaultFetchFields = [\"formattedAddress\", \"addressComponents\"]; // Fields to fetch for the selected place (can be extended).\n\n  /**\n   * Class constructor for PacAutocomplete.\n   * Initializes the autocomplete widget with the provided configuration.\n   * @param {Object} config - Configuration object for the autocomplete widget.\n   * @param {string} config.containerId - ID of the container element for the widget.\n   * @param {string} config.googleMapsApiKey - Google Maps API key.\n   * @param {string} [config.googleMapsApiVersion] - Version of the Google Maps API to use (default: \"weekly\").\n   * @param {Object} [config.options] - Additional options for the widget (e.g., classes, callbacks).\n   * @param {Object} [config.requestParams] - Parameters for the autocomplete request (e.g., input, region).\n   * @param {*} config\n   */\n  constructor(config) {\n    // console.log(\"PacAutocomplete constructor called.\", config.requestParams);\n    if (!config || !config.containerId || !config.googleMapsApiKey) {\n      throw new Error(\n        \"PacAutocomplete: Missing required configuration (containerId, googleMapsApiKey).\"\n      );\n    }\n\n    this.#containerId = config.containerId; // Store the configuration object\n    this.#pacEl = document.getElementById(config.containerId);\n    if (!this.#pacEl) {\n      throw new Error(\n        `PacAutocomplete: Container element with ID \"${config.containerId}\" not found.`\n      );\n    }\n\n    this.#googleMapsApiKey = config.googleMapsApiKey;\n    this.#googleMapsApiVersion = config.googleMapsApiVersion || \"weekly\";\n\n    // Merge user options with defaults\n    this.#options = {\n      ...this.#defaultOptions, // Default options\n      ...config.options, // User-defined options override defaults\n    };\n    // Ensure classes are deeply merged if user provides partial classes\n    if (config.options && config.options.classes) {\n      this.#options.classes = {\n        ...this.#defaultClasses,\n        ...config.options.classes,\n      };\n    } else {\n      this.#options.classes = this.#defaultClasses; // Use default classes if none provided\n    }\n    //console.log(this.#options);\n\n    if (config.fetchFields && Array.isArray(config.fetchFields)) {\n      this._setFetchFields(config.fetchFields); // Set fetch fields from user config\n    }\n\n    // Set default response and error callbacks if not provided\n    this.#onDataCallback =\n      config.onResponse ||\n      ((place) => {\n        console.info(\"---------Default onResponse not provided---------\");\n        console.info(\"Selected Place:\", JSON.stringify(place, null, 2));\n      });\n    this.#onErrorCallback =\n      config.onError ||\n      ((error) => {\n        console.error(\"---------Default onError not provided---------\");\n        console.error(\"PAC Error:\", error);\n      });\n\n    if (config.requestParams && Object.keys(config.requestParams).length > 0) {\n      this.#request = {\n        ...this.#defaultRequestParams,\n        ...config.requestParams,\n      };\n    } else {\n      this.#request = { ...this.#defaultRequestParams }; // Use defaults if no requestParams provided\n    }\n\n    //console.log(this.#request);\n\n    this._init(); // Underscore prefix for internal initialization method\n  }\n\n  // --- Private Initialization Method ---\n  async _init() {\n    try {\n      // check if google maps api is already loaded\n      if (typeof google === \"undefined\" || !google.maps) {\n        // Load the Google Maps API dynamically\n        await this._loadGoogleMapsApi({\n          key: this.#googleMapsApiKey,\n          v: this.#googleMapsApiVersion,\n        });\n      }\n      this._createPACStructure(); // Pass this.#options\n      await this._initializeAutocomplete(); // Pass this.#options\n      //console.log(\"PacAutocomplete Initialized for container:\", this.#pacEl.id);\n    } catch (error) {\n      this.#onErrorCallback(error);\n    }\n  }\n\n  /**\n   * Sets the fields to fetch for the selected place.\n   * @param {Array<string>} fields - The fields to fetch.\n   */\n  _setFetchFields(fields) {\n    if (Array.isArray(fields) && fields.length > 0) {\n      this.#fetchFields = [\n        ...new Set([...this.#defaultFetchFields, ...fields]),\n      ].filter((e) => e); // Ensure unique and non-empty fields\n    }\n  }\n\n  /**\n   * Creates a debounced version of a function.\n   * The debounced function delays invoking `func` until after `wait` milliseconds have\n   * elapsed since the last time the debounced function was invoked.\n   * @param {Function} func - The function to debounce.\n   * @param {number} wait - The number of milliseconds to delay.\n   * @returns {Function} The new debounced function.\n   */\n  _debounce(func, wait) {\n    let timeout = null;\n    return function executedFunction(...args) {\n      const later = () => {\n        timeout = null;\n        func(...args); // Call original function\n      };\n      if (timeout !== null) {\n        clearTimeout(timeout); // Clear the previous timeout\n      }\n      timeout = setTimeout(later, wait ?? 100); // Set the new timeout\n    };\n  }\n  /**\n   * Formats a distance in meters into kilometers or miles.\n   * @param {number | null | undefined} distance - Distance in meters.\n   * @param {'km' | 'miles'} units - The desired output units.\n   * @returns {string | null} Formatted distance string (e.g., \"1.23 km\") or null if input is invalid.\n   */\n  _formatDistance(distance, units) {\n    if (typeof distance !== \"number\" || !this.#options.distance) {\n      return null; // Return null if distance isn't shown or invalid\n    }\n    let value;\n    let unitLabel;\n    if (units === \"km\") {\n      value = (distance / 1000).toFixed(2);\n      unitLabel = \"km\";\n    } else {\n      // Default to miles if not 'km'\n      value = (distance / 1609.34).toFixed(2);\n      unitLabel = \"miles\";\n    }\n    // Avoid showing \".00\"\n    value = value.replace(/\\.00$/, \"\");\n    return `${value} ${unitLabel}`;\n  }\n\n  /**\n   * Dynamically loads the Google Maps JavaScript API using the importLibrary method.\n   * This is the standard approach recommended by Google.\n   * @see https://developers.google.com/maps/documentation/javascript/load-maps-js-api\n   * @param {object} g - Configuration object for the API loader (key, v, libraries, etc.).\n   */\n  async _loadGoogleMapsApi(g) {\n    var h, // Promise tracking API load\n      a, // Script element\n      k, // Loop variable for config keys\n      p = \"The Google Maps JavaScript API\", // Error message prefix\n      c = \"google\", // Global namespace\n      l = \"importLibrary\", // Loader function name\n      q = \"__ib__\", // Internal callback name\n      m = document, // Document reference\n      b = window; // Window reference\n    b = b[c] || (b[c] = {}); // Ensure google namespace exists\n    var d = b.maps || (b.maps = {}), // Ensure google.maps namespace exists\n      r = new Set(), // Set to track requested libraries\n      e = new URLSearchParams(), // URL parameters for the API script\n      u = () =>\n        // Function to initiate API loading (if not already started)\n        h ||\n        // eslint-disable-next-line no-async-promise-executor\n        (h = new Promise(async (f, n) => {\n          // Create script element (done async to potentially wait for nonce)\n          // await (a = m.createElement('script')); // Original Google code had await here, might not be needed\n          a = m.createElement(\"script\"); // Create script tag\n          e.set(\"libraries\", [...r].join(\",\")); // Add accumulated libraries\n          // Add other parameters from the config object 'g'\n          for (k in g)\n            e.set(\n              k.replace(/[A-Z]/g, (t) => \"_\" + t[0].toLowerCase()), // Convert camelCase to snake_case\n              g[k]\n            );\n          e.set(\"callback\", c + \".maps.\" + q); // Set the internal callback function name\n          a.src = `https://maps.${c}apis.com/maps/api/js?` + e; // Construct the API URL\n          d[q] = f; // Assign the promise resolver to the callback name on google.maps\n          // Error handling for script loading failure\n          a.onerror = () => (h = n(Error(p + \" could not load.\"))); // Use onerror for load failures\n          // Nonce for Content Security Policy\n          a.nonce = m.querySelector(\"script[nonce]\")?.nonce || \"\";\n          m.head.append(a); // Append the script to the document head\n        }));\n    // Define or reuse the importLibrary function on google.maps\n    // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n    d[l]\n      ? console.warn(p + \" only loads once. Ignoring:\", g) // Warn if called again\n      : (d[l] = (f, ...n) => r.add(f) && u().then(() => d[l](f, ...n))); // The actual importLibrary implementation\n  }\n\n  // --- UI Creation ---\n  _createPACStructure() {\n    const section = document.createElement(\"section\");\n    this.#options.classes.section\n      .split(\" \")\n      .forEach((cl) => cl && section.classList.add(cl));\n\n    // Main container\n    this.#container = document.createElement(\"div\");\n    this.#container.className = this.#options.classes.container;\n    this.#container.setAttribute(\"id\", this.#containerId + \"-div\");\n    section.appendChild(this.#container);\n\n    // Icon\n    const iconContainer = document.createElement(\"div\");\n    iconContainer.className = this.#options.classes.icon_container;\n    this.#container.appendChild(iconContainer);\n    const icon = document.createElement(\"div\");\n    icon.innerHTML = this.#options.classes.icon;\n    iconContainer.appendChild(icon.firstElementChild); // Append the actual SVG element\n\n    // Input field\n    this.#inputElement = document.createElement(\"input\");\n    this.#inputElement.id = this.#containerId + \"-input\"; // Assign ID for label association\n    this.#inputElement.type = \"text\";\n    this.#inputElement.name = \"search\"; // Consider making name configurable\n    this.#inputElement.placeholder = this.#options.placeholder;\n    this.#inputElement.autocomplete = this.#options.autocomplete;\n    this.#inputElement.className = this.#options.classes.input;\n    this.#inputElement.setAttribute(\"role\", \"combobox\");\n    this.#inputElement.setAttribute(\"aria-autocomplete\", \"list\");\n    this.#inputElement.setAttribute(\"aria-expanded\", \"false\"); // Will be updated dynamically\n    this.#inputElement.setAttribute(\"aria-controls\", \"pacSuggestions\"); // Links to the suggestions list\n\n    if (this.#options.autofocus) {\n      this.#inputElement.autofocus = true;\n    }\n    if (this.#options.label) {\n      const label = document.createElement(\"label\");\n      label.htmlFor = this.#containerId + \"-labelInput\"; // Assuming inputElement gets this ID\n      label.textContent = this.#options.label;\n      // Add label classes if needed from opts.classes\n      this.#container.appendChild(label); // Append label before input or adjust structure\n    }\n    this.#container.appendChild(this.#inputElement);\n\n    // Keyboard hints container\n    const kbdContainer = document.createElement(\"div\");\n    kbdContainer.className = this.#options.classes.kbd_container;\n    this.#kbdEscape = document.createElement(\"kbd\");\n    this.#kbdEscape.className = this.#options.classes.kbd_escape;\n    this.#kbdEscape.textContent = \"Esc\";\n    kbdContainer.appendChild(this.#kbdEscape);\n    this.#kbdUp = document.createElement(\"kbd\");\n    this.#kbdUp.className = this.#options.classes.kbd_up;\n    this.#kbdUp.innerHTML = \"&#8593;\"; // Up arrow HTML entity\n    kbdContainer.appendChild(this.#kbdUp);\n    this.#kbdDown = document.createElement(\"kbd\");\n    this.#kbdDown.className = this.#options.classes.kbd_down;\n    this.#kbdDown.innerHTML = \"&#8595;\"; // Down arrow HTML entity\n    kbdContainer.appendChild(this.#kbdDown);\n    this.#container.appendChild(kbdContainer);\n\n    // Suggestions list (initially hidden)\n    this.#ul = document.createElement(\"ul\");\n    this.#ul.id = \"pacSuggestions\"; // Must match aria-controls\n    this.#ul.className = this.#options.classes.ul;\n    this.#ul.style.display = \"none\";\n    this.#ul.setAttribute(\"role\", \"listbox\");\n    this.#container.appendChild(this.#ul);\n\n    this.#pacEl.appendChild(section);\n    section.addEventListener(\"keydown\", this._onKeyDown.bind(this)); // Bind 'this'\n  }\n\n  /**\n   * Initializes the core autocomplete functionality after the API is loaded.\n   * Imports necessary libraries and sets up the input event listener.\n   */\n  async _initializeAutocomplete() {\n    try {\n      // Ensure the 'places' library is available via the dynamic loader\n      // eslint-disable-next-line no-undef\n      await google.maps.importLibrary(\"places\");\n      // console.log('Places library imported successfully.'); // For debugging\n\n      // Initial token generation\n      this._refreshToken();\n\n      // Attach the debounced request function to the input element's 'input' event\n      if (this.#inputElement) {\n        this.#inputElement.addEventListener(\n          \"input\",\n          this._debouncedMakeAcRequest.bind(this)\n        );\n        // Add focus/blur listeners if needed to manage suggestion visibility\n        this.#inputElement.addEventListener(\"blur\", () => {\n          // Delay hiding suggestions to allow click events on them\n          setTimeout(() => {\n            if (this.#ul && !this.#ul.contains(document.activeElement)) {\n              // Check if focus moved outside suggestions\n              this.#ul.style.display = \"none\";\n              this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n            }\n          }, 200); // Adjust delay as needed\n        });\n        this.#inputElement.addEventListener(\"focus\", () => {\n          // Potentially show suggestions again if input has value\n          if (this.#inputElement.value && this.#allSuggestions.length > 0) {\n            this.#ul.style.display = \"block\";\n            this.#inputElement.setAttribute(\"aria-expanded\", \"true\");\n          }\n        });\n      } else {\n        this.#onErrorCallback(\n          new Error(\"Input element not found during initialization.\")\n        );\n      }\n    } catch (error) {\n      console.error(\"Error initializing Google Places Autocomplete:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(\n        new Error(\"Google Maps Places library not available.\")\n      );\n    }\n  }\n\n  /**\n   * Resets the autocomplete input field, clears suggestions, and optionally refreshes the session token.\n   * @param {boolean} [refresh=false] - Whether to refresh the Google Places session token.\n   */\n  _reset(refresh = false, placeData = null) {\n    this.#currentSuggestion = -1;\n\n    /**\n     * If the input element exists and clear_input is false, set its value to the formatted address\n     * from placeData. Otherwise, clear the input value.\n     * This allows the user to keep the input value if they selected a place,\n     * but still allows clearing it if clear_input is true or placeData is not provided.\n     * @type {HTMLInputElement}\n     * @property {string} value - The value of the input element.\n     * @property {boolean} clear_input - Whether to clear the input value after selection.\n     * @property {Object} placeData - The data of the selected place, containing formattedAddress.\n     */\n    if (\n      this.#inputElement &&\n      this.#options.clear_input == false &&\n      placeData &&\n      placeData.formattedAddress\n    ) {\n      this.#inputElement.value = placeData.formattedAddress; // Set input value to formatted address\n    } else if (this.#inputElement) {\n      this.#inputElement.value = \"\";\n    }\n\n    if (this.#inputElement) {\n      this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n      this.#inputElement.blur();\n    }\n\n    this.#allSuggestions = [];\n    this.#currentSuggestion = -1;\n    if (this.#ul) {\n      this.#ul.innerHTML = \"\"; // Clear existing suggestions\n      this.#ul.style.display = \"none\";\n    }\n    if (refresh) {\n      this._refreshToken();\n    }\n  }\n  /**\n   * Removes the 'current' highlighting classes from all suggestion list items (li) and their links (a).\n   */\n  _resetLiClasses() {\n    if (!this.#ul) return;\n    Array.from(this.#ul.children).forEach((li) => {\n      this.#options.classes.li_current\n        .split(\" \")\n        .forEach((cl) => li.classList.remove(cl));\n      const link = li.querySelector(\"a\");\n      if (link) {\n        this.#options.classes.li_a_current\n          .split(\" \")\n          .forEach((cl) => link.classList.remove(cl));\n      }\n    });\n  }\n\n  /**\n   * Handles keyboard events (ArrowDown, ArrowUp, Enter, Escape) for navigating\n   * and selecting suggestions or closing the list.\n   * @param {KeyboardEvent} e - The keyboard event object.\n   */\n  _onKeyDown(e) {\n    this._resetLiClasses(); // Reset classes on any key press within the suggestions\n\n    if (e.key === \"Escape\") {\n      e.preventDefault();\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdEscape?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdEscape?.classList.remove(cl)),\n        300\n      );\n\n      this._reset(true); // Reset search input and results, refresh token\n    }\n\n    if (\n      !this.#allSuggestions.length ||\n      !this.#ul ||\n      this.#ul.style.display === \"none\"\n    )\n      return;\n\n    if (e.key === \"ArrowDown\") {\n      e.preventDefault(); // Prevent cursor movement in input\n      this.#currentSuggestion = Math.min(\n        this.#currentSuggestion + 1,\n        this.#allSuggestions.length - 1\n      );\n      if (this.#currentSuggestion < 0) this.#currentSuggestion = 0; // Handle case where it was -1\n\n      const currentLi = this.#ul.children.item(this.#currentSuggestion);\n      if (currentLi) {\n        const currentA = currentLi.querySelector(\"a\");\n        this.#options.classes.li_current\n          .split(\" \")\n          .forEach((cl) => currentLi.classList.add(cl));\n        if (currentA) {\n          this.#options.classes.li_a_current\n            .split(\" \")\n            .forEach((cl) => currentA.classList.add(cl));\n        }\n        currentLi.scrollIntoView({ block: \"nearest\" }); // Ensure visible\n      }\n\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdDown?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdDown?.classList.remove(cl)),\n        300\n      );\n    } else if (e.key === \"ArrowUp\") {\n      e.preventDefault(); // Prevent cursor movement in input\n      this.#currentSuggestion = Math.max(this.#currentSuggestion - 1, 0); // Stay at 0 if already there\n\n      const currentLi = this.#ul.children.item(this.#currentSuggestion);\n      if (currentLi) {\n        const currentA = currentLi.querySelector(\"a\");\n        this.#options.classes.li_current\n          .split(\" \")\n          .forEach((cl) => currentLi.classList.add(cl));\n        if (currentA) {\n          this.#options.classes.li_a_current\n            .split(\" \")\n            .forEach((cl) => currentA.classList.add(cl));\n        }\n        currentLi.scrollIntoView({ block: \"nearest\" }); // Ensure visible\n      }\n\n      // Visual feedback for key press\n      this.#options.classes.kbd_active\n        .split(\" \")\n        .forEach((cl) => this.#kbdUp?.classList.add(cl));\n      setTimeout(\n        () =>\n          this.#options.classes.kbd_active\n            .split(\" \")\n            .forEach((cl) => this.#kbdUp?.classList.remove(cl)),\n        300\n      );\n    } else if (e.key === \"Enter\") {\n      e.preventDefault(); // Prevent form submission if applicable\n      if (\n        this.#currentSuggestion >= 0 &&\n        this.#currentSuggestion < this.#allSuggestions.length\n      ) {\n        this._onPlaceSelected(\n          this.#allSuggestions[this.#currentSuggestion].place\n        );\n        // Reset is handled within onPlaceSelected via reset(true)\n      }\n    }\n  }\n\n  /**\n   * Debounced function to fetch autocomplete suggestions from the Google Places API.\n   * Triggered by the 'input' event on the input element.\n   */\n  _debouncedMakeAcRequest = this._debounce(async () => {\n    if (!this.#inputElement || !this.#inputElement.value) {\n      this._reset();\n      if (this.#inputElement)\n        this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n      return;\n    }\n\n    this.#request.input = this.#inputElement.value;\n    //console.log(\"Request:\", this.#request); // Debugging\n    try {\n      const { suggestions } =\n        // eslint-disable-next-line no-undef\n        await google.maps.places.AutocompleteSuggestion.fetchAutocompleteSuggestions(\n          this.#request\n        );\n\n      // Display suggestions\n      if (suggestions && suggestions.length > 0) {\n        this.#ul.replaceChildren(\n          ...this._createSuggestionElements(suggestions)\n        );\n        this.#ul.style.display = \"block\";\n        this.#inputElement.setAttribute(\"aria-expanded\", \"true\");\n      } else {\n        // No suggestions found\n        this._reset(); // Clear any old suggestions\n        this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n        // Optionally display a \"no results\" message in the 'ul'\n      }\n    } catch (error) {\n      this.#onErrorCallback(error);\n      this._reset();\n      // if (this.#inputElement)\n      //   this.#inputElement.setAttribute(\"aria-expanded\", \"false\");\n    }\n  }, this.#options?.debounce ?? 100);\n\n  /**\n   * Creates an array of list item (LI) elements for the suggestions dropdown.\n   * Each LI contains a link (A) with the place prediction details and distance.\n   * Handles highlighting the matched parts of the suggestion text.\n   * @param {Array<google.maps.places.AutocompleteSuggestion>} suggestions - Array of suggestion objects from the API.\n   * @returns {Array<HTMLLIElement>} An array of LI elements to be added to the suggestions UL.\n   */\n  _createSuggestionElements(suggestions) {\n    this.#allSuggestions = []; // Reset before populating\n    return suggestions.map((suggestion, index) => {\n      this.#allSuggestions.push({\n        id: index + 1,\n        description: suggestion.placePrediction.toString(),\n        place: suggestion.placePrediction.toPlace(),\n      });\n\n      // create div elements\n      const divContainer = document.createElement(\"div\");\n      divContainer.className = this.#options.classes.li_div_container; // flex min-w-0 gap-x-4\n      // create inner div element - place name\n      const divInner = document.createElement(\"div\");\n      divInner.className = this.#options.classes.li_div_one; // min-w-0 flex-auto\n      divContainer.appendChild(divInner);\n      // create p element - place name\n      const p = document.createElement(\"p\");\n      p.className = this.#options.classes.li_div_one_p; // text-sm/6\n\n      // get prediction text\n      const predictionText = suggestion.placePrediction.text;\n      const originalText = predictionText.text;\n      // Array of objects with startOffset, endOffset\n      const matches = predictionText.matches;\n\n      //Highlighting Logic\n      let lastIndex = 0;\n\n      // Sort matches just in case they aren't ordered (though they usually are)\n      matches.sort((a, b) => a.startOffset - b.startOffset);\n\n      // 1. Create the outer span\n      const outerSpan = document.createElement(\"span\");\n\n      // 2. Create the inner span for the bold part\n      const innerSpan = document.createElement(\"span\");\n      innerSpan.classList = this.#options.classes.highlight ?? \"font-bold\"; // Use the highlight class from options\n\n      for (const match of matches) {\n        // Append text before the current match\n        outerSpan.textContent += originalText.substring(\n          lastIndex,\n          match.startOffset\n        );\n\n        // Append the highlighted match segment\n        if (match.startOffset > 0) {\n          // check previous charter is space\n          const prevChar = originalText.charAt(match.startOffset - 1);\n          if (prevChar == \" \") {\n            innerSpan.textContent += \" \";\n          }\n        }\n        innerSpan.textContent += originalText.substring(\n          match.startOffset,\n          match.endOffset\n        );\n\n        // Update the last index processed\n        lastIndex = match.endOffset;\n      }\n\n      // 3. Create a text node for the remaining text\n      const remainingText = document.createTextNode(\n        originalText.substring(lastIndex)\n      );\n\n      // 4. Append the inner span and the text node to the outer span\n      outerSpan.appendChild(innerSpan);\n      outerSpan.appendChild(remainingText);\n\n      // 5. Append the outer span to the paragraph element\n      p.appendChild(outerSpan);\n\n      divInner.appendChild(p);\n      divContainer.appendChild(divInner);\n\n      // create inner div element - distance\n      const divInner2 = document.createElement(\"div\");\n      divInner2.className = this.#options.classes.li_div_two; //'shrink-0 flex flex-col items-end min-w-16';\n      divContainer.appendChild(divInner2);\n      // create p element - distance\n      const p2 = document.createElement(\"p\");\n      p2.className = this.#options.classes.li_div_two_p; //'mt-1 text-xs/5 ';\n      p2.textContent = this._formatDistance(\n        suggestion.placePrediction.distanceMeters,\n        this.#options.distance_units ?? \"km\"\n      );\n      divInner2.appendChild(p2);\n\n      // // create a link element\n      const a = document.createElement(\"a\");\n      a.href = \"javascript:void(0)\";\n      a.tabIndex = index + 1;\n      a.className = this.#options.classes.li_a; // block w-full flex justify-between\n\n      a.addEventListener(\"click\", () => {\n        this._onPlaceSelected(suggestion.placePrediction.toPlace());\n      });\n\n      // ...\n      // a.addEventListener(\"click\", () => {\n      //   this._fetchPlaceDetails(prediction.place_id);\n      // });\n      a.appendChild(divContainer);\n      a.appendChild(divInner2);\n\n      const li = document.createElement(\"li\");\n      li.id = `option-${index + 1}`;\n      li.className = this.#options.classes.li;\n\n      li.appendChild(a);\n      return li;\n    });\n  }\n\n  /**\n   * Handles the selection of a place. Fetches required fields\n   * (displayName, formattedAddress, addressComponents) and calls the\n   * user-defined `onPacData` callback.\n   * @param {google.maps.places.Place} place - The selected Place object.\n   */\n  async _onPlaceSelected(place) {\n    let data = null;\n    try {\n      // Fetch necessary details for the selected place\n      await place.fetchFields({\n        fields: this.#fetchFields, //[\"displayName\", \"formattedAddress\", \"addressComponents\"], // Add more fields as needed\n      });\n      // Call the user-provided callback with the place data\n      // eslint-disable-next-line no-undef\n      data = place.toJSON(); // Convert to plain JSON object\n      this.#onDataCallback(data); // Convert to plain JSON object for the callback\n    } catch (error) {\n      console.error(\"Error fetching place details:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(error);\n    } finally {\n      // Reset the input and suggestions regardless of success/error\n      this._reset(true, data); // Refresh token after selection\n    }\n  }\n\n  /**\n   * Creates a new Google Places Autocomplete Session Token.\n   * This should be called before starting a new series of autocomplete requests.\n   */\n  _refreshToken() {\n    try {\n      // eslint-disable-next-line no-undef\n      this.#request.sessionToken =\n        new google.maps.places.AutocompleteSessionToken();\n    } catch (error) {\n      console.error(\"Error creating session token:\", error);\n      // eslint-disable-next-line no-undef\n      this.#onErrorCallback(error);\n    }\n  }\n\n  /**\n   * Sets the fields to be fetched for the selected place.\n   * This allows you to specify which details you want to retrieve\n   * when a place is selected, such as displayName, formattedAddress,\n   * addressComponents, etc.\n   * @param {Array<string>} fields - Array of field names to fetch.\n   */\n  setFetchFields(fields) {\n    this._setFetchFields(fields);\n  }\n  /**\n   * Gets the current fields that will be fetched for the selected place.\n   * This is useful for understanding what details will be available\n   * when a place is selected, such as displayName, formattedAddress,\n   * addressComponents, etc.\n   * @returns {Array<string>} The current fetch fields.\n   */\n  getFetchFields() {\n    return this.#fetchFields;\n  }\n\n  /**\n   * Sets the request parameters for the Places Autocomplete instance.\n   * This method allows you to update the request parameters dynamically,\n   * such as the input value, region codes, language, etc.\n   * It merges the provided parameters with the default request parameters,\n   * allowing you to override specific values while keeping the defaults intact.\n   * This is useful for updating the search criteria without needing to recreate the instance.\n   * @param {*} params\n   */\n  setRequestParams(params) {\n    if (\n      typeof params === \"object\" &&\n      !Array.isArray(params) &&\n      params !== null\n    ) {\n      // if params.input is provided, set it to the input element\n      if (params.input && typeof params.input === \"string\") {\n        this.#inputElement.value = params.input; // Set input value if provided\n      }\n      // Merge provided params with default request parameters\n      // This allows overriding specific request parameters while keeping defaults\n      this.#request = {\n        ...this.#defaultRequestParams,\n        ...params,\n      };\n    }\n  }\n\n  /**\n   * Gets the current request parameters used by the Places Autocomplete instance.\n   * @returns {Object} The current request parameters.\n   */\n  getRequestParams() {\n    /**\n     * Returns the current request parameters used by the Places Autocomplete instance.\n     * This includes the input value, included region codes, language, and other settings.\n     * It is useful for debugging or when you need to know the current search criteria.\n     * @returns {Object} The current request parameters.\n     */\n    return this.#request;\n  }\n\n  /**\n   * Sets the options for the Places Autocomplete instance.\n   * This method allows you to change the appearance and behavior of the autocomplete widget,\n   * such as classes, placeholder text, debounce time, etc.\n   * It merges the provided options with the default options, allowing you to override specific values\n   * while keeping the defaults intact.\n   * This is useful for updating the widget's configuration without needing to recreate the instance.\n   * @param {*} options\n   */\n  setOptions(options) {\n    if (\n      typeof options === \"object\" &&\n      !Array.isArray(options) &&\n      options !== null\n    ) {\n      // Ensure classes are deeply merged if user provides partial classes\n      const tmpClasses = options.classes || {};\n      delete options.classes; // Remove classes from options to avoid overwriting\n\n      // Merge provided options with default options\n      // This allows overriding specific options while keeping defaults\n      this.#options = {\n        ...this.#defaultOptions,\n        ...options,\n      };\n\n      this.#inputElement.placeholder = this.#options.placeholder; // Update placeholder text\n      this.#inputElement.autocomplete = this.#options.autocomplete; // Update autocomplete attribute\n      this.#inputElement.autofocus = this.#options.autofocus; // Update autofocus attribute\n      this.#inputElement.debounce = this.#options.debounce; // Update debounce attribute\n      this.#inputElement.clear_input = this.#options.clear_input; // Update clear_input attribute\n      this.#inputElement.distance = this.#options.distance; // Update distance attribute\n      this.#inputElement.distance_units = this.#options.distance_units; // Update distance units attribute\n      this.#inputElement.label = this.#options.label; // Update label text\n\n      this.#inputElement.setAttribute(\n        \"aria-label\",\n        this.#options.label || \"Search for places\"\n      ); // Update ARIA label\n      this.#inputElement.setAttribute(\n        \"aria-autocomplete\",\n        this.#options.aria_autocomplete || \"list\"\n      ); // Update ARIA autocomplete attribute\n      this.#inputElement.setAttribute(\n        \"aria-expanded\",\n        this.#options.aria_expanded || \"false\"\n      ); // Update ARIA expanded attribute\n      this.#inputElement.setAttribute(\n        \"aria-controls\",\n        this.#options.aria_controls || \"pacSuggestions\"\n      ); // Update ARIA controls attribute\n      this.#inputElement.setAttribute(\"role\", this.#options.role || \"combobox\"); // Update ARIA role attribute\n      this.#inputElement.setAttribute(\n        \"aria-required\",\n        this.#options.aria_required || \"false\"\n      ); // Update ARIA required attribute\n      this.#inputElement.setAttribute(\n        \"aria-activedescendant\",\n        this.#options.aria_activedescendant || \"\"\n      ); // Update ARIA activedescendant attribute\n\n      // Merge classes with defaults\n      // This allows overriding specific classes while keeping defaults\n      if (\n        tmpClasses &&\n        typeof tmpClasses === \"object\" &&\n        Object.keys(tmpClasses).length > 0\n      ) {\n        this.#options.classes = {\n          ...this.#defaultClasses,\n          ...tmpClasses,\n        };\n      }\n\n      // Update the classes of the container and input element\n      if (this.#container && this.#options.classes?.container) {\n        this.#container.className = this.#options.classes.container; // Update container class\n      }\n      if (this.#inputElement && this.#options.classes?.input) {\n        this.#inputElement.className = this.#options.classes.input; // Update input class\n      }\n      // Update the classes of the suggestions list\n      if (this.#ul && this.#options.classes?.ul) {\n        this.#ul.className = this.#options.classes.ul; // Update suggestions list class\n      }\n      // Update the classes of the keyboard hints\n      if (this.#kbdEscape && this.#options.classes?.kbd_escape) {\n        this.#kbdEscape.className = this.#options.classes.kbd_escape; // Update Escape key hint class\n      }\n      if (this.#kbdUp && this.#options.classes?.kbd_up) {\n        this.#kbdUp.className = this.#options.classes.kbd_up; // Update Up arrow key hint class\n      }\n      if (this.#kbdDown && this.#options.classes?.kbd_down) {\n        this.#kbdDown.className = this.#options.classes.kbd_down; // Update Down arrow key hint class\n      }\n      // Update the classes of the section\n      if (this.#pacEl) {\n        const section = this.#pacEl.querySelector(\"section\");\n\n        if (section && this.#options.classes?.section) {\n          this.#options.classes.section\n            .split(\" \")\n            .forEach((cl) => cl && section.classList.add(cl));\n        }\n      }\n    }\n  }\n\n  /**\n   * Gets the current options used by the Places Autocomplete instance.\n   * @returns {Object} The current options.\n   */\n  getOptions() {\n    /**\n     * Returns the current options used by the Places Autocomplete instance.\n     * This includes classes, placeholder text, debounce time, and other settings.\n     * It is useful for debugging or when you need to know the current configuration of the widget.\n     * @returns {Object} The current options.\n     */\n    return this.#options;\n  }\n\n  /**\n   * Clears the autocomplete input field and suggestions list.\n   * This method resets the state of the autocomplete widget,\n   * allowing the user to start a new search without any previous input or suggestions.\n   * It also refreshes the Google Places session token to ensure a new session.\n   * @returns {void}\n   */\n  clear() {\n    this._reset(true);\n  }\n\n  /**\n   * Destroys the PacAutocomplete instance.\n   * Removes event listeners, clears the DOM, and nullifies properties.\n   * This method should be called when the autocomplete widget is no longer needed.\n   * It ensures that all resources are cleaned up to prevent memory leaks.\n   * @returns {void}\n   */\n  destroy() {\n    // Remove event listeners, remove elements from DOM\n    if (this.#inputElement) {\n      this.#inputElement.removeEventListener(\n        \"input\",\n        this._debouncedMakeAcRequest\n      );\n      // remove other listeners\n    }\n    if (this.#pacEl && this.#container) {\n      this.#pacEl.removeChild(this.#container.parentElement); // remove the whole section\n    }\n    // Nullify properties\n    for (const prop in this) {\n      if (Object.hasOwn(this, prop)) {\n        this[prop] = null;\n      }\n    }\n    console.log(\"PacAutocomplete instance destroyed.\");\n  }\n}\n"],"names":["_a","_containerId","_pacEl","_googleMapsApiKey","_googleMapsApiVersion","_options","_request","_inputElement","_container","_ul","_kbdEscape","_kbdUp","_kbdDown","_allSuggestions","_currentSuggestion","_onDataCallback","_onErrorCallback","_defaultOptions","_defaultClasses","_defaultRequestParams","_fetchFields","_defaultFetchFields","PlacesAutocomplete","config","__privateAdd","__publicField","__privateGet","suggestions","error","__privateSet","place","fields","e","func","wait","timeout","args","later","distance","units","value","unitLabel","g","h","a","k","p","c","l","q","m","b","d","r","u","f","n","t","section","cl","iconContainer","icon","label","kbdContainer","refresh","placeData","li","link","currentLi","currentA","suggestion","index","divContainer","divInner","predictionText","originalText","matches","lastIndex","outerSpan","innerSpan","match","remainingText","divInner2","p2","data","params","options","_b","_c","_d","_e","_f","_g","tmpClasses","prop"],"mappings":"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"}